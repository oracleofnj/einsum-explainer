{"version":3,"sources":["pkg/einsum_wasm.js","types/einsum_typeguards.ts","utils/parseAndTypecheckJSON.ts","appstate/ducks/updateEquation.ts","utils/parseShapeStrings.ts","utils/parseOutputString.ts","appstate/ducks/updateShape.ts","utils/parseDataString.ts","appstate/ducks/updateContents.ts","appstate/ducks/updateOptimizationMethod.ts","appstate/makeOperand.ts","utils/range.ts","appstate/presets.ts","appstate/ducks/loadPreset.ts","appstate/appState.ts","appstate/makeReducer.ts","components/layout/InputColumn.tsx","components/EquationInput.tsx","utils/makeLatexString.ts","components/layout/OutputColumn.tsx","components/EquationOutput.tsx","components/layout/InputOutputRow.tsx","components/Equation.tsx","components/AxisLengthsOutput.tsx","components/ShapesInput.tsx","components/Shapes.tsx","components/ComputationOutput.tsx","components/ContentsInput.tsx","components/Computation.tsx","components/Presets.tsx","utils/showPath.ts","components/EinsumPathDetails.tsx","components/EinsumPathOutput.tsx","components/EinsumPathInput.tsx","components/EinsumPath.tsx","components/EinsumExplainer.tsx","components/App.tsx","utils/serviceWorker.js","index.js"],"names":["wasm","passStringToWasm","__exports","WASM_VECTOR_LEN","cachedTextEncoder","TextEncoder","cachegetUint8Memory","getUint8Memory","buffer","memory","Uint8Array","encodeInto","arg","size","length","ptr","__wbindgen_malloc","offset","mem","code","charCodeAt","slice","__wbindgen_realloc","view","subarray","written","buf","encode","set","cachedTextDecoder","TextDecoder","getStringFromWasm","len","decode","cachedGlobalArgumentPtr","globalArgumentPtr","__wbindgen_global_argument_ptr","cachegetUint32Memory","getUint32Memory","Uint32Array","validateAsJson","input_string","ptr0","len0","retptr","rustptr","rustlen","realRet","__wbindgen_free","validateAndSizeFromShapesAsStringAsJson","operand_shapes","ptr1","len1","einsumPathAsJson","flattened_operands_as_string","optimization_method","ptr2","len2","slowEinsumAsJson","init","module","result","imports","./einsum_wasm","URL","Request","response","fetch","WebAssembly","instantiateStreaming","catch","e","console","warn","then","r","arrayBuffer","bytes","instantiate","Instance","instance","_ref","exports","__wbindgen_wasm_module","isErrorMessage","hasOwnProperty","isNumberArray","Array","every","x","getShape","arr","Ok","innerShape","_loop","i","nextShape","v","val","ix","Err","_ret","concat","Object","toConsumableArray","isNDArray","isProbablyNDArray","first","isContraction","operand_indices","isSizedContraction","contraction","entries","_ref2","slicedToArray","isOutputSize","output_size","isFlattenedOperand","shape","contents","isSingletonOrder","Singleton","isOperandNumberInput","Input","isOperandNumber","IntermediateResult","isOperandNumberIntermediate","isOrderPair","sized_contraction","lhs","rhs","isOperandNumPair","operand_nums","isPairsOrder","Pairs","isSingletonSteps","SingletonContraction","method","isSimplificationMethod","new_indices","einsum_string","isPairStep","lhs_simplification","rhs_simplification","simplified_einsum_string","isPairSteps","PairContractions","isEinsumPath","isContractionOrder","contraction_order","isPathSteps","steps","parseAndTypecheckJSON","str","typeguard","problematicFunctionName","obj","JSON","parse","_unused","err","isOk","enforce","action","type","equation","updateEquation","actionCreator","reducer","state","visibleSizes","einsumExplanation","objectSpread","TypeError","stringify","parseShapeString","shapeString","bracketedShapeString","replace","parseOutput","output","unflatten","stride","push","UPDATE_SHAPE","index","getContents","totalLength","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","return","fill","ret","updateShape","data","oldOperand","operandStates","contentsVector","contentsStr","newNDArray","shapeStr","parseDataString","dataString","bracketedDataString","UPDATE_CONTENTS","updateContents","Error","flat","Math","pow","optimizationMethod","updateOptimizationMethod","makeOperand","start","arguments","step","stop","range","reduce","product","ndArray","getState","_presetFn","presetFn","presets","matrixMultiplication","description","matrixTransposition","sum2D","columnSum","rowSum","getDiagonal","matrixVectorMultiplication","outerProduct","batchMM1","batchMM2","tensorContraction","bilinearTransformation","preset","loadPreset","initialState","appActions","updateEquationDuck","updateShapeDuck","updateContentsDuck","updateOptimizationMethodDuck","loadPresetDuck","ducks","appReducers","forEach","duck","makeReducer","InputColumn","prompt","control","react_default","a","createElement","className","React","memo","dispatch","onChange","target","makeLatexString","outputMatrix","output_indices","join","summationSymbols","summation_indices","map","idx","inputMatrices","indices","n","asciiA","matrixName","String","fromCharCode","subscripts","OutputColumn","index_es","title","icon","faTimesCircle","color","faCheckCircle","props","explanation","explanationJSON","dangerouslySetInnerHTML","__html","renderToString","InputOutputRow","input","style","paddingTop","paddingBottom","equationJSON","components_EquationInput","components_EquationOutput","sizedExplanationJSON","sizedExplanation","outputMap","operandShapes","shapes","makeOnShapeChange","Fragment","key","shapeArrays","some","filter","_ref3","Tensor","components_ShapesInput","components_AxisLengthsOutput","computationOutput","computationOutputJSON","operandContents","makeOnContentsChange","operands","min","components_ContentsInput","components_ComputationOutput","presetChoices","_useState","useState","_useState2","selectedPreset","setSelectedPreset","name","treeifyStep","pairs","intermediateNum","orderAndStep","_orderAndStep$operand","resolve","num","sourceType","source","getSimplification","simplificationMethod","EinsumPathDetails","treeNode","level","paddingLeft","einsumPath","einsumPathJSON","path","pairContractions","zipSteps","tree","treeifySteps","components_EinsumPathDetails","components_EinsumPathInput","components_EinsumPathOutput","EinsumExplainer","appState","components_Presets","components_Equation","components_Shapes","components_Computation","components_EinsumPath","App","_useReducer","useReducer","_useReducer2","Date","now","components_EinsumExplainer","Boolean","window","location","hostname","match","_run","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","ReactDOM","render","src_components_App","document","getElementById","apply","this","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.392aacf2.chunk.js","sourcesContent":["\nconst __exports = {};\nlet wasm;\n\nlet WASM_VECTOR_LEN = 0;\n\nlet cachedTextEncoder = new TextEncoder('utf-8');\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nlet passStringToWasm;\nif (typeof cachedTextEncoder.encodeInto === 'function') {\n    passStringToWasm = function(arg) {\n\n\n        let size = arg.length;\n        let ptr = wasm.__wbindgen_malloc(size);\n        let offset = 0;\n        {\n            const mem = getUint8Memory();\n            for (; offset < arg.length; offset++) {\n                const code = arg.charCodeAt(offset);\n                if (code > 0x7F) break;\n                mem[ptr + offset] = code;\n            }\n        }\n\n        if (offset !== arg.length) {\n            arg = arg.slice(offset);\n            ptr = wasm.__wbindgen_realloc(ptr, size, size = offset + arg.length * 3);\n            const view = getUint8Memory().subarray(ptr + offset, ptr + size);\n            const ret = cachedTextEncoder.encodeInto(arg, view);\n\n            offset += ret.written;\n        }\n        WASM_VECTOR_LEN = offset;\n        return ptr;\n    };\n} else {\n    passStringToWasm = function(arg) {\n\n\n        let size = arg.length;\n        let ptr = wasm.__wbindgen_malloc(size);\n        let offset = 0;\n        {\n            const mem = getUint8Memory();\n            for (; offset < arg.length; offset++) {\n                const code = arg.charCodeAt(offset);\n                if (code > 0x7F) break;\n                mem[ptr + offset] = code;\n            }\n        }\n\n        if (offset !== arg.length) {\n            const buf = cachedTextEncoder.encode(arg.slice(offset));\n            ptr = wasm.__wbindgen_realloc(ptr, size, size = offset + buf.length);\n            getUint8Memory().set(buf, ptr + offset);\n            offset += buf.length;\n        }\n        WASM_VECTOR_LEN = offset;\n        return ptr;\n    };\n}\n\nlet cachedTextDecoder = new TextDecoder('utf-8');\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n\nlet cachedGlobalArgumentPtr = null;\nfunction globalArgumentPtr() {\n    if (cachedGlobalArgumentPtr === null) {\n        cachedGlobalArgumentPtr = wasm.__wbindgen_global_argument_ptr();\n    }\n    return cachedGlobalArgumentPtr;\n}\n\nlet cachegetUint32Memory = null;\nfunction getUint32Memory() {\n    if (cachegetUint32Memory === null || cachegetUint32Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint32Memory = new Uint32Array(wasm.memory.buffer);\n    }\n    return cachegetUint32Memory;\n}\n/**\n* @param {string} input_string\n* @returns {string}\n*/\nexport function validateAsJson(input_string) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.validateAsJson(retptr, ptr0, len0);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n\n    }\n\n}\n__exports.validateAsJson = validateAsJson\n\n/**\n* @param {string} input_string\n* @param {string} operand_shapes\n* @returns {string}\n*/\nexport function validateAndSizeFromShapesAsStringAsJson(input_string, operand_shapes) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const ptr1 = passStringToWasm(operand_shapes);\n    const len1 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.validateAndSizeFromShapesAsStringAsJson(retptr, ptr0, len0, ptr1, len1);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n        wasm.__wbindgen_free(ptr1, len1 * 1);\n\n    }\n\n}\n__exports.validateAndSizeFromShapesAsStringAsJson = validateAndSizeFromShapesAsStringAsJson\n\n/**\n* @param {string} input_string\n* @param {string} flattened_operands_as_string\n* @param {string} optimization_method\n* @returns {string}\n*/\nexport function einsumPathAsJson(input_string, flattened_operands_as_string, optimization_method) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const ptr1 = passStringToWasm(flattened_operands_as_string);\n    const len1 = WASM_VECTOR_LEN;\n    const ptr2 = passStringToWasm(optimization_method);\n    const len2 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.einsumPathAsJson(retptr, ptr0, len0, ptr1, len1, ptr2, len2);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n        wasm.__wbindgen_free(ptr1, len1 * 1);\n        wasm.__wbindgen_free(ptr2, len2 * 1);\n\n    }\n\n}\n__exports.einsumPathAsJson = einsumPathAsJson\n\n/**\n* @param {string} input_string\n* @param {string} flattened_operands_as_string\n* @returns {string}\n*/\nexport function slowEinsumAsJson(input_string, flattened_operands_as_string) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const ptr1 = passStringToWasm(flattened_operands_as_string);\n    const len1 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.slowEinsumAsJson(retptr, ptr0, len0, ptr1, len1);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n        wasm.__wbindgen_free(ptr1, len1 * 1);\n\n    }\n\n}\n__exports.slowEinsumAsJson = slowEinsumAsJson\n\nfunction init(module) {\n    let result;\n    const imports = { './einsum_wasm': __exports };\n\n    if (module instanceof URL || typeof module === 'string' || module instanceof Request) {\n\n        const response = fetch(module);\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            result = WebAssembly.instantiateStreaming(response, imports)\n            .catch(e => {\n                console.warn(\"`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n                return response\n                .then(r => r.arrayBuffer())\n                .then(bytes => WebAssembly.instantiate(bytes, imports));\n            });\n        } else {\n            result = response\n            .then(r => r.arrayBuffer())\n            .then(bytes => WebAssembly.instantiate(bytes, imports));\n        }\n    } else {\n\n        result = WebAssembly.instantiate(module, imports)\n        .then(result => {\n            if (result instanceof WebAssembly.Instance) {\n                return { instance: result, module };\n            } else {\n                return result;\n            }\n        });\n    }\n    return result.then(({instance, module}) => {\n        wasm = instance.exports;\n        init.__wbindgen_wasm_module = module;\n\n        return wasm;\n    });\n}\n\nexport default init;\n\n","export type ErrorMessage = {\n  Err: string;\n};\n\nexport function isErrorMessage(r: any): r is ErrorMessage {\n  return (r as object).hasOwnProperty(\"Err\");\n}\n\nexport type Result<T> = { Ok: T } | ErrorMessage;\n\nexport function isOk<T>(r: any, typeguard: (obj: any) => obj is T): r is Result<T> {\n  return (r as object).hasOwnProperty(\"Ok\") && typeguard((r as { Ok: T }).Ok);\n}\n\nexport function enforce<T>(\n  obj: any,\n  typeguard: (obj: any) => obj is T,\n  err: ErrorMessage\n): Result<T> {\n  if (isOk(obj, typeguard)) {\n    return obj;\n  } else if (isErrorMessage(obj)) {\n    return obj;\n  } else {\n    return err;\n  }\n}\n\nexport function isNumberArray(r: any): r is number[] {\n  return r instanceof Array && r.every(x => typeof x === \"number\");\n}\n\nexport type NDArray = number | NDArrayArray;\n\ninterface NDArrayArray extends Array<NDArray> {}\n\nfunction isProbablyNDArray(r: any): r is NDArray {\n  if (typeof r === \"number\") {\n    return true;\n  }\n  if (!(r instanceof Array)) {\n    return false;\n  }\n  if (isNumberArray(r) && r.length !== 0) {\n    return true;\n  }\n  const first = r[0];\n  if (!(first instanceof Array) || first.length === 0) {\n    return false;\n  }\n  const len = first.length;\n  return (\n    len !== 0 && r.every(x => x instanceof Array && x.length === len && isProbablyNDArray(x))\n  );\n}\n\nexport function getShape(arr: NDArray): Result<number[]> {\n  if (typeof arr === \"number\") {\n    return { Ok: [] };\n  }\n  const innerShape = getShape(arr[0]);\n  if (isErrorMessage(innerShape)) {\n    return innerShape;\n  }\n  for (let i = 1; i < arr.length; i++) {\n    const nextShape = getShape(arr[i]);\n    if (isErrorMessage(nextShape)) {\n      return nextShape;\n    }\n    if (!innerShape.Ok.every((val, ix) => nextShape.Ok[ix] === val)) {\n      return {\n        Err: \"Array contains elements with different shapes\"\n      };\n    }\n  }\n  return { Ok: [arr.length, ...innerShape.Ok] };\n}\n\nexport function isNDArray(r: any): r is NDArray {\n  if (!isProbablyNDArray(r)) {\n    return false;\n  }\n  const shape = getShape(r);\n  return !isErrorMessage(shape);\n}\n\nexport type Contraction = {\n  operand_indices: string[][];\n  output_indices: string[];\n  summation_indices: string[];\n};\n\nexport function isContraction(r: object): r is Contraction {\n  return (\n    r.hasOwnProperty(\"operand_indices\") &&\n    (r as Contraction).operand_indices instanceof Array &&\n    (r as Contraction).operand_indices.every(x => x instanceof Array) &&\n    r.hasOwnProperty(\"output_indices\") &&\n    r.hasOwnProperty(\"summation_indices\")\n  );\n}\n\nexport type OutputSize = { [key: string]: number };\n\nexport function isOutputSize(r: any): r is OutputSize {\n  return Object.entries(r as object).every(([_, val]) => typeof val === \"number\");\n}\n\nexport type SizedContraction = {\n  contraction: Contraction;\n  output_size: OutputSize;\n};\n\nexport function isSizedContraction(r: object): r is SizedContraction {\n  return (\n    r.hasOwnProperty(\"contraction\") &&\n    isContraction((r as SizedContraction).contraction) &&\n    r.hasOwnProperty(\"output_size\") &&\n    isOutputSize((r as SizedContraction).output_size)\n  );\n}\n\nexport type FlattenedOperand = {\n  shape: number[];\n  contents: number[];\n};\n\nexport function isFlattenedOperand(r: object): r is FlattenedOperand {\n  return (\n    r.hasOwnProperty(\"shape\") &&\n    isNumberArray((r as FlattenedOperand).shape) &&\n    r.hasOwnProperty(\"contents\") &&\n    isNumberArray((r as FlattenedOperand).contents)\n  );\n}\n\nexport type SingletonOrder = {\n  Singleton: SizedContraction;\n};\n\nexport function isSingletonOrder(r: object): r is SingletonOrder {\n  return r.hasOwnProperty(\"Singleton\") && isSizedContraction((r as SingletonOrder).Singleton);\n}\n\nexport type OperandNumberInput = {\n  Input: number;\n};\n\nexport function isOperandNumberInput(r: object): r is OperandNumberInput {\n  return r.hasOwnProperty(\"Input\") && typeof (r as OperandNumberInput).Input === \"number\";\n}\n\nexport type OperandNumberIntermediate = {\n  IntermediateResult: number;\n};\n\nexport function isOperandNumberIntermediate(r: object): r is OperandNumberIntermediate {\n  return (\n    r.hasOwnProperty(\"IntermediateResult\") &&\n    typeof (r as OperandNumberIntermediate).IntermediateResult === \"number\"\n  );\n}\n\nexport type OperandNumber = OperandNumberInput | OperandNumberIntermediate;\n\nexport function isOperandNumber(r: object): r is OperandNumber {\n  return isOperandNumberInput(r) || isOperandNumberIntermediate(r);\n}\n\nexport type OperandNumPair = {\n  lhs: OperandNumber;\n  rhs: OperandNumber;\n};\n\nexport function isOperandNumPair(r: object): r is OperandNumPair {\n  return (\n    r.hasOwnProperty(\"lhs\") &&\n    isOperandNumber((r as OperandNumPair).lhs) &&\n    r.hasOwnProperty(\"rhs\") &&\n    isOperandNumber((r as OperandNumPair).rhs)\n  );\n}\n\nexport type OrderPair = {\n  sized_contraction: SizedContraction;\n  operand_nums: OperandNumPair;\n};\n\nexport function isOrderPair(r: object): r is OrderPair {\n  return (\n    r.hasOwnProperty(\"sized_contraction\") &&\n    isSizedContraction((r as OrderPair).sized_contraction) &&\n    r.hasOwnProperty(\"operand_nums\") &&\n    isOperandNumPair((r as OrderPair).operand_nums)\n  );\n}\n\nexport type PairsOrder = {\n  Pairs: OrderPair[];\n};\n\nexport function isPairsOrder(r: object): r is PairsOrder {\n  return (\n    r.hasOwnProperty(\"Pairs\") &&\n    (r as PairsOrder).Pairs instanceof Array &&\n    (r as PairsOrder).Pairs.every(isOrderPair)\n  );\n}\n\nexport type ContractionOrder = SingletonOrder | PairsOrder;\n\nexport function isContractionOrder(r: object): r is ContractionOrder {\n  return isSingletonOrder(r) || isPairsOrder(r);\n}\n\nexport type SingletonSteps = {\n  SingletonContraction: {\n    method: string;\n  };\n};\n\nexport function isSingletonSteps(r: object): r is SingletonSteps {\n  return (\n    r.hasOwnProperty(\"SingletonContraction\") &&\n    typeof (r as SingletonSteps).SingletonContraction === \"object\" &&\n    (r as SingletonSteps).SingletonContraction.hasOwnProperty(\"method\") &&\n    typeof (r as SingletonSteps).SingletonContraction.method === \"string\"\n  );\n}\n\nexport type SimplificationMethod = {\n  method: string;\n  new_indices: string[];\n  einsum_string: string;\n};\n\nexport function isSimplificationMethod(r: object): r is SimplificationMethod {\n  return (\n    r.hasOwnProperty(\"method\") &&\n    typeof (r as SimplificationMethod).method === \"string\" &&\n    r.hasOwnProperty(\"new_indices\") &&\n    (r as SimplificationMethod).new_indices instanceof Array &&\n    (r as SimplificationMethod).new_indices.every(x => typeof x === \"string\") &&\n    r.hasOwnProperty(\"einsum_string\") &&\n    typeof (r as SimplificationMethod).einsum_string === \"string\"\n  );\n}\n\nexport type PairStep = {\n  lhs_simplification: SimplificationMethod | null;\n  rhs_simplification: SimplificationMethod | null;\n  method: string;\n  simplified_einsum_string: string;\n};\n\nexport function isPairStep(r: object): r is PairStep {\n  return (\n    r.hasOwnProperty(\"lhs_simplification\") &&\n    ((r as PairStep).lhs_simplification === null ||\n      isSimplificationMethod((r as PairStep).lhs_simplification as object)) &&\n    r.hasOwnProperty(\"rhs_simplification\") &&\n    ((r as PairStep).rhs_simplification === null ||\n      isSimplificationMethod((r as PairStep).rhs_simplification as object)) &&\n    r.hasOwnProperty(\"method\") &&\n    typeof (r as PairStep).method === \"string\" &&\n    r.hasOwnProperty(\"simplified_einsum_string\") &&\n    typeof (r as PairStep).simplified_einsum_string === \"string\"\n  );\n}\n\nexport type PairSteps = {\n  PairContractions: PairStep[];\n};\n\nexport function isPairSteps(r: object): r is PairSteps {\n  return (\n    r.hasOwnProperty(\"PairContractions\") &&\n    (r as PairSteps).PairContractions instanceof Array &&\n    (r as PairSteps).PairContractions.every(isPairStep)\n  );\n}\n\nexport type PathSteps = SingletonSteps | PairSteps;\n\nexport function isPathSteps(r: object): r is PathSteps {\n  return isSingletonSteps(r) || isPairSteps(r);\n}\n\nexport type EinsumPath = {\n  contraction_order: ContractionOrder;\n  steps: PathSteps;\n};\n\nexport function isEinsumPath(r: object): r is EinsumPath {\n  return (\n    r.hasOwnProperty(\"contraction_order\") &&\n    isContractionOrder((r as EinsumPath).contraction_order) &&\n    r.hasOwnProperty(\"steps\") &&\n    isPathSteps((r as EinsumPath).steps)\n  );\n}\n","import { Result, enforce } from \"../types/einsum_typeguards\";\n\nexport default function parseAndTypecheckJSON<T>(\n  str: string,\n  typeguard: (r: any) => r is T,\n  problematicFunctionName: string\n): Result<T> {\n  let obj;\n  try {\n    obj = JSON.parse(str);\n  } catch {\n    return {\n      Err: `${problematicFunctionName} returned invalid JSON`\n    };\n  }\n  return enforce(obj, typeguard, {\n    Err: `${problematicFunctionName} returned valid JSON but of the wrong type`\n  });\n}\n","import { validateAsJson } from \"../../pkg/einsum_wasm\";\nimport { isContraction, isErrorMessage } from \"../../types/einsum_typeguards\";\nimport { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport parseAndTypecheckJSON from \"../../utils/parseAndTypecheckJSON\";\n\nconst UPDATE_EQUATION = \"updateEquation\";\n\nexport interface UpdateEquationAction extends AnyAction {\n  equation: string;\n}\n\nconst typeguard = (action: AppAction): action is UpdateEquationAction =>\n  action.type === UPDATE_EQUATION &&\n  action.hasOwnProperty(\"equation\") &&\n  typeof (action as UpdateEquationAction).equation === \"string\";\n\nconst actionCreator = (equation: string): UpdateEquationAction => ({\n  type: UPDATE_EQUATION,\n  equation\n});\n\nconst reducer = (state: AppState, action: AppAction): AppState => {\n  if (typeguard(action)) {\n    const { equation } = action;\n    let { visibleSizes } = state;\n\n    const einsumExplanation = parseAndTypecheckJSON(\n      validateAsJson(equation),\n      isContraction,\n      \"validateAsJson\"\n    );\n    if (!isErrorMessage(einsumExplanation)) {\n      visibleSizes = einsumExplanation.Ok.operand_indices.length;\n    }\n\n    return {\n      ...state,\n      visibleSizes,\n      equation: (action as UpdateEquationAction).equation\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ action }));\n  }\n};\n\nexport default {\n  type: UPDATE_EQUATION,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import { Result, isNumberArray } from \"../types/einsum_typeguards\";\n\nfunction parseShapeString(shapeString: string): Result<number[]> {\n  const bracketedShapeString = shapeString.replace(/\\(/g, \"[\").replace(/\\)/g, \"]\");\n  let obj;\n  try {\n    obj = JSON.parse(bracketedShapeString);\n  } catch {\n    return {\n      Err: \"Not a valid shape\"\n    };\n  }\n  return isNumberArray(obj) ? { Ok: obj } : { Err: \"Not a valid shape\" };\n}\n\nexport { parseShapeString };\n","import { FlattenedOperand, NDArray } from \"../types/einsum_typeguards\";\n\nfunction unflatten(shape: number[], contents: number[]): NDArray {\n  switch (shape.length) {\n    case 0:\n      return contents[0];\n    case 1:\n      return contents.slice();\n    default:\n      const result: NDArray = [];\n      let stride = 1;\n      for (let i = 1; i < shape.length; i++) {\n        stride *= shape[i];\n      }\n      for (let i = 0; i < shape[0]; i++) {\n        result.push(unflatten(shape.slice(1), contents.slice(i * stride, (i + 1) * stride)));\n      }\n      return result;\n  }\n}\n\nexport default function parseOutput(output: FlattenedOperand): NDArray {\n  const { shape, contents } = output;\n  return unflatten(shape, contents);\n}\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport { parseShapeString } from \"../../utils/parseShapeStrings\";\nimport { isErrorMessage } from \"../../types/einsum_typeguards\";\nimport parseOutput from \"../../utils/parseOutputString\";\n\nexport interface UpdateShapeAction extends AnyAction {\n  index: number;\n  shape: string;\n}\n\nconst UPDATE_SHAPE = \"updateShape\";\nfunction typeguard(action: AppAction): action is UpdateShapeAction {\n  return (\n    action.type === UPDATE_SHAPE &&\n    action.hasOwnProperty(\"index\") &&\n    typeof (action as UpdateShapeAction).index === \"number\" &&\n    action.hasOwnProperty(\"shape\") &&\n    typeof (action as UpdateShapeAction).shape === \"string\"\n  );\n}\n\nfunction actionCreator(index: number, shape: string): UpdateShapeAction {\n  return {\n    type: UPDATE_SHAPE,\n    index,\n    shape\n  };\n}\n\nfunction getContents(v: number[], shape: number[]) {\n  let totalLength = 1;\n  for (const s of shape) {\n    totalLength *= s;\n  }\n  if (!(v instanceof Array)) {\n    return Array(totalLength).fill(0);\n  }\n  const ret = [];\n  for (let i = 0; i < totalLength; i++) {\n    if (typeof v[i] !== \"number\") {\n      ret.push(0);\n    } else {\n      ret.push(v[i]);\n    }\n  }\n  return ret;\n}\n\nfunction reducer(state: AppState, action: AppAction): AppState {\n  if (typeguard(action)) {\n    const { index, shape } = action;\n    const data = parseShapeString(shape);\n    const oldOperand = state.operandStates[index];\n    const { contentsVector } = oldOperand;\n    let { contentsStr } = oldOperand;\n    if (!isErrorMessage(data)) {\n      const newNDArray = parseOutput({\n        shape: data.Ok,\n        contents: getContents(contentsVector, data.Ok)\n      });\n      contentsStr = JSON.stringify(newNDArray);\n    }\n\n    return {\n      ...state,\n      operandStates: [\n        ...state.operandStates.slice(0, index),\n        {\n          ...oldOperand,\n          shapeStr: shape,\n          contentsStr,\n          contentsVector\n        },\n        ...state.operandStates.slice(index + 1)\n      ]\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ reducer: UPDATE_SHAPE, action }));\n  }\n}\n\nexport default {\n  type: UPDATE_SHAPE,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import { Result, isNDArray, NDArray } from \"../types/einsum_typeguards\";\n\nfunction parseDataString(dataString: string): Result<NDArray> {\n  const bracketedDataString = dataString.replace(/\\(/g, \"[\").replace(/\\)/g, \"]\");\n  let obj;\n  try {\n    obj = JSON.parse(bracketedDataString);\n  } catch {\n    return {\n      Err: \"Not a valid ndArray\"\n    };\n  }\n  return isNDArray(obj) ? { Ok: obj } : { Err: \"Not a valid ndArray\" };\n}\n\nexport { parseDataString };\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport { parseDataString } from \"../../utils/parseDataString\";\nimport { isErrorMessage, getShape } from \"../../types/einsum_typeguards\";\n\nexport interface UpdateContentsAction extends AnyAction {\n  index: number;\n  contents: string;\n}\n\nconst UPDATE_CONTENTS = \"updateContents\";\nfunction typeguard(action: AppAction): action is UpdateContentsAction {\n  return (\n    action.type === UPDATE_CONTENTS &&\n    action.hasOwnProperty(\"index\") &&\n    typeof (action as UpdateContentsAction).index === \"number\" &&\n    action.hasOwnProperty(\"contents\") &&\n    typeof (action as UpdateContentsAction).contents === \"string\"\n  );\n}\n\nfunction actionCreator(index: number, contents: string): UpdateContentsAction {\n  return {\n    type: UPDATE_CONTENTS,\n    index,\n    contents\n  };\n}\n\nfunction reducer(state: AppState, action: AppAction): AppState {\n  if (typeguard(action)) {\n    const { index, contents } = action;\n    const data = parseDataString(contents);\n    const oldOperand = state.operandStates[index];\n    let { shapeStr, contentsVector } = oldOperand;\n    if (!isErrorMessage(data)) {\n      const shape = getShape(data.Ok);\n      if (isErrorMessage(shape)) {\n        throw new Error(\"This shouldn't be possible\");\n      }\n      shapeStr = JSON.stringify(shape.Ok)\n        .replace(/\\[/g, \"(\")\n        .replace(/\\]/g, \")\");\n      contentsVector = (data.Ok as number[]).flat(2 ** 16);\n    }\n\n    return {\n      ...state,\n      operandStates: [\n        ...state.operandStates.slice(0, index),\n        {\n          ...oldOperand,\n          shapeStr,\n          contentsVector,\n          contentsStr: contents\n        },\n        ...state.operandStates.slice(index + 1)\n      ]\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ reducer: UPDATE_CONTENTS, action }));\n  }\n}\n\nexport default {\n  type: UPDATE_CONTENTS,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\n\nconst UPDATE_OPTIMIZATION_METHOD = \"updateOptimizationMethod\";\n\nexport interface UpdateOptimizationMethod extends AnyAction {\n  optimizationMethod: string;\n}\n\nconst typeguard = (action: AppAction): action is UpdateOptimizationMethod =>\n  action.type === UPDATE_OPTIMIZATION_METHOD &&\n  action.hasOwnProperty(\"optimizationMethod\") &&\n  typeof (action as UpdateOptimizationMethod).optimizationMethod === \"string\";\n\nconst actionCreator = (optimizationMethod: string): UpdateOptimizationMethod => ({\n  type: UPDATE_OPTIMIZATION_METHOD,\n  optimizationMethod\n});\n\nconst reducer = (state: AppState, action: AppAction): AppState => {\n  if (typeguard(action)) {\n    const { optimizationMethod } = action;\n\n    return {\n      ...state,\n      optimizationMethod\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ action }));\n  }\n};\n\nexport default {\n  type: UPDATE_OPTIMIZATION_METHOD,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import range from \"../utils/range\";\nimport parseOutput from \"../utils/parseOutputString\";\nimport { operandState } from \"./appState\";\n\nexport default function makeOperand(\n  shape: number[],\n  start: number = 0,\n  step: number = 1\n): operandState {\n  if (shape.length === 0) {\n    return {\n      shapeStr: \"()\",\n      contentsStr: \"[]\",\n      contentsVector: []\n    };\n  }\n  const totalSize = shape.reduce((product, val) => val * product, 1);\n  const contents = range(start, start + step * totalSize, step);\n  const ndArray = parseOutput({ shape, contents });\n  return {\n    shapeStr: JSON.stringify(shape)\n      .replace(/\\[/g, \"(\")\n      .replace(/\\]/g, \")\"),\n    contentsStr: JSON.stringify(ndArray),\n    contentsVector: contents\n  };\n}\n","export default function range(start: number, stop?: number, step: number = 1) {\n  if (step === 0) {\n    throw new Error(\"range: step must not be zero\");\n  }\n  if (stop === undefined) {\n    stop = start;\n    start = 0;\n  }\n  const result: number[] = [];\n  let val = start;\n  while (val < stop) {\n    result.push(val);\n    val += step;\n  }\n  return result;\n}\n","import { AppState, operandState } from \"./appState\";\nimport makeOperand from \"./makeOperand\";\n\ntype PartialAppState = {\n  equation: string;\n  operandStates: operandState[];\n};\n\ntype Preset = {\n  description: string;\n  presetFn: () => PartialAppState;\n};\n\nconst presets: { [key: string]: Preset } = {\n  matrixMultiplication: {\n    description: \"Matrix Multiplication\",\n    presetFn: () => ({\n      equation: \"ij,jk->ik\",\n      operandStates: [makeOperand([2, 3], 0, 1), makeOperand([3, 5], 0, 10)]\n    })\n  },\n  matrixTransposition: {\n    description: \"Matrix Transposition (Implicit)\",\n    presetFn: () => ({\n      equation: \"ji\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  sum2D: {\n    description: \"Sum All Elements (2D)\",\n    presetFn: () => ({\n      equation: \"ij->\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  columnSum: {\n    description: \"Sum Each Column\",\n    presetFn: () => ({\n      equation: \"ij->j\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  rowSum: {\n    description: \"Sum Each Row\",\n    presetFn: () => ({\n      equation: \"ij->i\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  getDiagonal: {\n    description: \"Take the Diagonal\",\n    presetFn: () => ({\n      equation: \"ii->i\",\n      operandStates: [makeOperand([3, 3], 0, 1)]\n    })\n  },\n  matrixVectorMultiplication: {\n    description: \"Matrix-Vector Multiplication\",\n    presetFn: () => ({\n      equation: \"ij,j->i\",\n      operandStates: [makeOperand([2, 3], 0, 1), makeOperand([3], 0, 10)]\n    })\n  },\n  outerProduct: {\n    description: \"Outer Product\",\n    presetFn: () => ({\n      equation: \"i,j->ij\",\n      operandStates: [makeOperand([3], 0, 1), makeOperand([4], 10, 10)]\n    })\n  },\n  batchMM1: {\n    description: \"Batch Matrix Multiplication (single RHS)\",\n    presetFn: () => ({\n      equation: \"nij,jk->nik\",\n      operandStates: [makeOperand([4, 2, 5], 0, 1), makeOperand([5, 3], 0, 10)]\n    })\n  },\n  batchMM2: {\n    description: \"Batch Matrix Multiplication (multiple RHS)\",\n    presetFn: () => ({\n      equation: \"nij,njk->nik\",\n      operandStates: [makeOperand([4, 2, 5], 0, 1), makeOperand([4, 5, 3], 0, 10)]\n    })\n  },\n  tensorContraction: {\n    description: \"Tensor Contraction\",\n    presetFn: () => ({\n      equation: \"pqrs,tuqr->pstu\",\n      operandStates: [makeOperand([2, 6, 7, 3], 0, 1), makeOperand([4, 5, 6, 7], 0, 10)]\n    })\n  },\n  bilinearTransformation: {\n    description: \"Bilinear Transformation\",\n    presetFn: () => ({\n      equation: \"ik,jkl,il->ij\",\n      operandStates: [\n        makeOperand([2, 3], 0, 1),\n        makeOperand([5, 3, 7], 0, 10),\n        makeOperand([2, 7], 0, 100)\n      ]\n    })\n  }\n};\n\nexport function getState({ presetFn }: Preset): AppState {\n  const { equation, operandStates } = presetFn();\n  const visibleSizes = operandStates.length;\n  return {\n    equation,\n    visibleSizes,\n    operandStates: [...operandStates, ...Array(256 - visibleSizes).fill(makeOperand([]))],\n    optimizationMethod: \"Naive\"\n  };\n}\n\nexport default presets;\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport presets, { getState } from \"../presets\";\n\nconst LOAD_PRESET = \"loadPreset\";\n\nexport interface LoadPresetAction extends AnyAction {\n  preset: string;\n}\n\nconst typeguard = (action: AppAction): action is LoadPresetAction =>\n  action.type === LOAD_PRESET &&\n  typeof (action as LoadPresetAction).preset === \"string\" &&\n  presets.hasOwnProperty((action as LoadPresetAction).preset);\n\nconst actionCreator = (preset: string): LoadPresetAction => ({\n  type: LOAD_PRESET,\n  preset\n});\n\nconst reducer = (state: AppState, action: AppAction): AppState => {\n  if (typeguard(action)) {\n    return getState(presets[action.preset]);\n  } else {\n    throw new TypeError(JSON.stringify({ action }));\n  }\n};\n\nexport default {\n  type: LOAD_PRESET,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import updateEquationDuck, { UpdateEquationAction } from \"./ducks/updateEquation\";\nimport updateShapeDuck, { UpdateShapeAction } from \"./ducks/updateShape\";\nimport updateContentsDuck, { UpdateContentsAction } from \"./ducks/updateContents\";\nimport updateOptimizationMethodDuck, {\n  UpdateOptimizationMethod\n} from \"./ducks/updateOptimizationMethod\";\nimport makeReducer from \"./makeReducer\";\nimport presets, { getState } from \"./presets\";\nimport loadPresetDuck, { LoadPresetAction } from \"./ducks/loadPreset\";\n\n// What is the state of the app?\n// (1) The string the user entered\n// (2) How many arrays are visible that can have a size entered\n// (3) The shapes that have been entered (as strings)\n// (4) The contents that have been entered (as strings)\n//\n// Note: (1) and (2) can conflict\n// This is OK!\n// However, when the string changes, update (2) automatically if the new string is valid\n\n// To make a new action:\n// (1) Make a duck (type, typeguard, actionCreator, reducer)\n// (2) Export the duck and an interface extending AnyAction from the duck file\n// (3) Import the duck and the action in this file\n// (4) Add the action to \"type AppAction\"\n// (5) Add the action to \"const appActions\"\n// (6) Add the duck to the call to makeReducer()\n\nexport type operandState = {\n  shapeStr: string;\n  contentsStr: string;\n  contentsVector: number[];\n};\n\nexport type AppState = {\n  equation: string;\n  visibleSizes: number;\n  operandStates: operandState[];\n  optimizationMethod: string;\n};\n\nconst initialState: AppState = getState(presets.matrixMultiplication);\n\nexport type AppAction =\n  | UpdateEquationAction\n  | UpdateOptimizationMethod\n  | UpdateShapeAction\n  | UpdateContentsAction\n  | LoadPresetAction;\n\nconst appActions = {\n  updateEquation: updateEquationDuck.actionCreator,\n  updateShape: updateShapeDuck.actionCreator,\n  updateContents: updateContentsDuck.actionCreator,\n  updateOptimizationMethod: updateOptimizationMethodDuck.actionCreator,\n  loadPreset: loadPresetDuck.actionCreator\n};\nconst reducer = makeReducer([\n  loadPresetDuck,\n  updateEquationDuck,\n  updateShapeDuck,\n  updateContentsDuck,\n  updateOptimizationMethodDuck\n]);\n\nexport { initialState, reducer, appActions };\n","import { AppState, AppAction } from \"./appState\";\n\nexport interface AnyAction {\n  type: string;\n}\n\nexport type Reducer = (state: AppState, action: AppAction) => AppState;\nexport type ActionCreator = (...args: any[]) => AppAction;\nexport type ActionTypeGuard = (action: AppAction) => boolean;\nexport type Duck = {\n  type: string;\n  typeguard: ActionTypeGuard;\n  actionCreator: ActionCreator;\n  reducer: Reducer;\n};\n\nexport default function makeReducer(ducks: Duck[]): Reducer {\n  const appReducers: { [key: string]: Reducer } = {};\n\n  ducks.forEach(duck => {\n    if (appReducers[duck.type]) {\n      throw new Error(`Multiple declarations for ${duck.type}`);\n    } else {\n      appReducers[duck.type] = duck.reducer;\n    }\n  });\n\n  return (state: AppState, action: AppAction): AppState =>\n    appReducers[action.type](state, action);\n}\n","import React from \"react\";\n\ntype InputColumnProps = {\n  prompt: string;\n  control: JSX.Element;\n};\n\nexport default function InputColumn({ prompt, control }: InputColumnProps) {\n  return (\n    <div className=\"row\">\n      <div className=\"col-xs-4 col-lg-3\">{prompt}</div>\n      <div className=\"col-xs-7 col-lg-9\">{control}</div>\n    </div>\n  );\n}\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype ExplainerInputProps = {\n  equation: string;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst EquationInput = ({ equation, dispatch }: ExplainerInputProps) => {\n  const onEquationChange = (e: ChangeEvent<HTMLInputElement>) => {\n    dispatch(appActions.updateEquation(e.target.value));\n  };\n\n  return (\n    <InputColumn\n      prompt=\"Equation:\"\n      control={<input type=\"text\" onChange={onEquationChange} value={equation} />}\n    />\n  );\n};\n\nexport default React.memo(EquationInput);\n","import { Contraction } from \"../types/einsum_typeguards\";\n\nfunction makeLatexString(contraction: Contraction): string {\n  // Out_{i,k}=\\sum_j A_{i,j} B_{j,k}\n  const outputMatrix = `Out_{${contraction.output_indices.join(\",\")}}`;\n  const summationSymbols = contraction.summation_indices.map(idx => `\\\\sum_${idx}`).join(\" \");\n  function makeInputMatrix(indices: string[], n: number) {\n    const asciiA: number = \"A\".charCodeAt(0);\n    const matrixName = String.fromCharCode(asciiA + n);\n    const subscripts = indices.join(\",\");\n\n    return `${matrixName}_{${subscripts}}`;\n  }\n  const inputMatrices = contraction.operand_indices.map(makeInputMatrix).join(\" \");\n\n  return `${outputMatrix} = ${summationSymbols} ${inputMatrices}`;\n}\n\nexport default makeLatexString;\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCheckCircle, faTimesCircle } from \"@fortawesome/free-solid-svg-icons\";\nimport { Result, isErrorMessage } from \"../../types/einsum_typeguards\";\n\ntype OutputColumnProps = {\n  output: Result<JSX.Element>;\n};\n\nexport default function OutputColumn({ output }: OutputColumnProps) {\n  return (\n    <div className=\"row\">\n      <div className=\"col-xs-2 col-xs-offset-2 col-md-offset-0 col-md-1\">\n        {isErrorMessage(output) ? (\n          <FontAwesomeIcon\n            title=\"Something went wrong!\"\n            icon={faTimesCircle}\n            size=\"2x\"\n            color=\"orangered\"\n          />\n        ) : (\n          <FontAwesomeIcon\n            title=\"Everything is cool!\"\n            icon={faCheckCircle}\n            size=\"2x\"\n            color=\"darkgreen\"\n          />\n        )}\n      </div>\n      <div className=\"col-xs-8 col-md-11\">\n        {isErrorMessage(output) ? output.Err : output.Ok}\n      </div>\n    </div>\n  );\n}\n","import { renderToString } from \"katex\";\nimport \"katex/dist/katex.min.css\";\nimport React from \"react\";\nimport { isErrorMessage, isContraction } from \"../types/einsum_typeguards\";\nimport makeLatexString from \"../utils/makeLatexString\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\n\ntype EquationOutputProps = {\n  explanationJSON: string;\n};\n\nconst EquationOutput = (props: EquationOutputProps) => {\n  const { explanationJSON } = props;\n  const explanation = parseAndTypecheckJSON(explanationJSON, isContraction, \"validateAsJson\");\n  const output = isErrorMessage(explanation)\n    ? explanation\n    : {\n        Ok: (\n          <div\n            dangerouslySetInnerHTML={{\n              __html: renderToString(makeLatexString(explanation.Ok))\n            }}\n          />\n        )\n      };\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(EquationOutput);\n","import React from \"react\";\n\ntype InputOutputProps = {\n  input: JSX.Element;\n  output: JSX.Element;\n};\n\nexport default function InputOutputRow({ input, output }: InputOutputProps) {\n  return (\n    <div className=\"row\" style={{ paddingTop: \"1em\", paddingBottom: \"1em\" }}>\n      <div className=\"col-xs-12 col-md-6\">{input}</div>\n      <div className=\"col-xs-12 col-md-6\">{output}</div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport EquationInput from \"./EquationInput\";\nimport { validateAsJson } from \"../pkg/einsum_wasm\";\nimport EquationOutput from \"./EquationOutput\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\n\ntype EquationProps = {\n  equation: string;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Equation = ({ equation, dispatch }: EquationProps) => {\n  const equationJSON = validateAsJson(equation);\n  return (\n    <InputOutputRow\n      input={<EquationInput equation={equation} dispatch={dispatch} />}\n      output={<EquationOutput explanationJSON={equationJSON} />}\n    />\n  );\n};\n\nexport default React.memo(Equation);\n","import React from \"react\";\nimport {\n  isErrorMessage,\n  isSizedContraction,\n  isContraction,\n  Result\n} from \"../types/einsum_typeguards\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\n\ntype AxisLengthOutputProps = {\n  equationJSON: string;\n  sizedExplanationJSON: string;\n};\n\nconst AxisLengthsOutput = ({ equationJSON, sizedExplanationJSON }: AxisLengthOutputProps) => {\n  let output: Result<JSX.Element>;\n\n  const explanation = parseAndTypecheckJSON(equationJSON, isContraction, \"validateAsJson\");\n\n  const sizedExplanation = parseAndTypecheckJSON(\n    sizedExplanationJSON,\n    isSizedContraction,\n    \"validateAndSizeFromShapesAsStringAsJson\"\n  );\n\n  if (isErrorMessage(sizedExplanation)) {\n    output = sizedExplanation;\n  } else if (isErrorMessage(explanation)) {\n    output = explanation;\n  } else {\n    // export type Contraction = {\n    //   operand_indices: string[];\n    //   output_indices: string[];\n    //   summation_indices: string[];\n    // };\n    const contraction = explanation.Ok;\n\n    // export type SizedContraction = {\n    //   contraction: Contraction;\n    //   output_size: OutputSize;\n    // };\n    // export type OutputSize = { [key: string]: number };\n    const outputMap = sizedExplanation.Ok.output_size;\n\n    output = {\n      Ok: (\n        <div>\n          <div>\n            Output size: [{contraction.output_indices.join(\", \")}] ={\" \"}\n            {JSON.stringify(contraction.output_indices.map(x => outputMap[x]))}\n          </div>\n          <div>\n            Summation index lengths:{\" \"}\n            {contraction.summation_indices.map(x => `${x}: ${outputMap[x]}`).join(\"; \")}\n          </div>\n        </div>\n      )\n    };\n  }\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(AxisLengthsOutput);\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype ShapesInputProps = {\n  visibleSizes: number;\n  operandShapes: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst ShapesInput = ({ operandShapes, visibleSizes, dispatch }: ShapesInputProps) => {\n  const shapes: string[] = [];\n  for (let i = 0; i < visibleSizes; i++) {\n    shapes.push(i < operandShapes.length ? operandShapes[i] : \"[]\");\n  }\n\n  const makeOnShapeChange = (index: number) => (e: ChangeEvent<HTMLInputElement>) => {\n    dispatch(appActions.updateShape(index, e.target.value));\n  };\n\n  return (\n    <>\n      {shapes.map((data, index) => (\n        <InputColumn\n          key={index}\n          prompt={`Shape of ${String.fromCharCode(index + \"A\".charCodeAt(0))}:`}\n          control={<input type=\"text\" onChange={makeOnShapeChange(index)} value={data} />}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default React.memo(ShapesInput);\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport { validateAndSizeFromShapesAsStringAsJson, validateAsJson } from \"../pkg/einsum_wasm\";\nimport AxisLengthsOutput from \"./AxisLengthsOutput\";\nimport { parseShapeString } from \"../utils/parseShapeStrings\";\nimport ShapesInput from \"./ShapesInput\";\nimport { isErrorMessage, ErrorMessage } from \"../types/einsum_typeguards\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\n\ntype ShapesProps = {\n  equation: string;\n  visibleSizes: number;\n  operandShapes: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Shapes = ({ equation, visibleSizes, operandShapes, dispatch }: ShapesProps) => {\n  const equationJSON = validateAsJson(equation);\n  const shapes = operandShapes.slice(0, visibleSizes);\n  const shapeArrays = shapes.map(parseShapeString);\n  let sizedExplanationJSON;\n  if (shapeArrays.some(isErrorMessage)) {\n    sizedExplanationJSON = JSON.stringify({\n      Err: JSON.stringify(\n        shapeArrays\n          .map((val, idx) => ({ val, idx }))\n          .filter(({ val }) => isErrorMessage(val))\n          .map(({ val, idx }) => ({ Tensor: idx, Error: (val as ErrorMessage).Err }))\n      )\n    });\n  } else {\n    sizedExplanationJSON = validateAndSizeFromShapesAsStringAsJson(\n      equation,\n      JSON.stringify(shapeArrays.map(x => (x as { Ok: number[] }).Ok))\n    );\n  }\n\n  return (\n    <InputOutputRow\n      input={\n        <ShapesInput\n          dispatch={dispatch}\n          visibleSizes={visibleSizes}\n          operandShapes={operandShapes}\n        />\n      }\n      output={\n        <AxisLengthsOutput\n          sizedExplanationJSON={sizedExplanationJSON}\n          equationJSON={equationJSON}\n        />\n      }\n    />\n  );\n};\n\nexport default React.memo(Shapes);\n","import React from \"react\";\nimport { isErrorMessage, isFlattenedOperand } from \"../types/einsum_typeguards\";\nimport parseOutput from \"../utils/parseOutputString\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\n\ntype ComputationOutputProps = {\n  computationOutputJSON: string;\n};\n\nconst ComputationOutput = (props: ComputationOutputProps) => {\n  const { computationOutputJSON } = props;\n  const computationOutput = parseAndTypecheckJSON(\n    computationOutputJSON,\n    isFlattenedOperand,\n    \"slowEinsumAsJson\"\n  );\n  const output = isErrorMessage(computationOutput)\n    ? computationOutput\n    : {\n        Ok: (\n          <>\n            Einsum Result:{\" \"}\n            <div>{JSON.stringify(parseOutput(computationOutput.Ok), null, 2)}</div>\n          </>\n        )\n      };\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(ComputationOutput);\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype ContentsInputProps = {\n  visibleSizes: number;\n  operandContents: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst ContentsInput = ({ operandContents, visibleSizes, dispatch }: ContentsInputProps) => {\n  const contents: string[] = [];\n  for (let i = 0; i < visibleSizes; i++) {\n    contents.push(i < operandContents.length ? operandContents[i] : \"[]\");\n  }\n\n  const makeOnContentsChange = (index: number) => (e: ChangeEvent<HTMLInputElement>) => {\n    dispatch(appActions.updateContents(index, e.target.value));\n  };\n\n  return (\n    <>\n      {contents.map((data, index) => (\n        <InputColumn\n          key={index}\n          prompt={`Contents of ${String.fromCharCode(index + \"A\".charCodeAt(0))}:`}\n          control={<input type=\"text\" onChange={makeOnContentsChange(index)} value={data} />}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default React.memo(ContentsInput);\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport { slowEinsumAsJson } from \"../pkg/einsum_wasm\";\nimport ComputationOutput from \"./ComputationOutput\";\nimport { parseShapeString } from \"../utils/parseShapeStrings\";\nimport ContentsInput from \"./ContentsInput\";\nimport { isErrorMessage } from \"../types/einsum_typeguards\";\nimport { parseDataString } from \"../utils/parseDataString\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\n\ntype ComputationProps = {\n  equation: string;\n  visibleSizes: number;\n  operandShapes: string[];\n  operandContents: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Computation = ({\n  equation,\n  visibleSizes,\n  operandShapes,\n  operandContents,\n  dispatch\n}: ComputationProps) => {\n  const shapes = operandShapes.slice(0, visibleSizes);\n  const contents = operandContents.slice(0, visibleSizes);\n  const operands = [];\n  for (let i = 0; i < Math.min(shapes.length, contents.length); i++) {\n    const shape = parseShapeString(shapes[i]);\n    const data = parseDataString(contents[i]);\n\n    if (!isErrorMessage(shape) && !isErrorMessage(data) && typeof data.Ok !== \"number\") {\n      operands.push({\n        shape: shape.Ok,\n        contents: data.Ok.flat(2 ** 16)\n      });\n    } else {\n      operands.push({\n        Err: `Array ${i} doesn't work`\n      });\n    }\n  }\n\n  const operandsJSON = JSON.stringify(operands);\n  const computationOutputJSON = slowEinsumAsJson(equation, operandsJSON);\n\n  return (\n    <InputOutputRow\n      input={\n        <ContentsInput\n          dispatch={dispatch}\n          visibleSizes={visibleSizes}\n          operandContents={operandContents}\n        />\n      }\n      output={<ComputationOutput computationOutputJSON={computationOutputJSON} />}\n    />\n  );\n};\n\nexport default React.memo(Computation);\n","import React, { ChangeEvent, useState } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\nimport presets from \"../appstate/presets\";\n\ntype PresetsProps = {\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Presets = ({ dispatch }: PresetsProps) => {\n  const presetChoices = Object.entries(presets);\n  const [selectedPreset, setSelectedPreset] = useState(presetChoices[0][0]);\n  const onPresetSelect = (e: ChangeEvent<HTMLSelectElement>) => {\n    setSelectedPreset(e.target.value);\n    dispatch(appActions.loadPreset(e.target.value));\n  };\n\n  return (\n    <InputOutputRow\n      input={\n        <InputColumn\n          prompt=\"Try one:\"\n          control={\n            <select value={selectedPreset} onChange={onPresetSelect}>\n              {presetChoices.map(([name, preset]) => (\n                <option key={name} value={name}>\n                  {preset.description}\n                </option>\n              ))}\n            </select>\n          }\n        />\n      }\n      output={<></>}\n    />\n  );\n};\n\nexport default React.memo(Presets);\n","import {\n  EinsumPath,\n  isPairsOrder,\n  isPairSteps,\n  isSingletonOrder,\n  isSingletonSteps,\n  OrderPair,\n  PairStep,\n  SizedContraction,\n  Result,\n  isOperandNumberInput,\n  OperandNumber,\n  SimplificationMethod\n} from \"../types/einsum_typeguards\";\n\nexport type OrderAndStep = OrderPair & PairStep;\ntype SizedContractionAndMethod = {\n  sized_contraction: SizedContraction;\n  method: string;\n};\ntype OrderAndSteps =\n  | {\n      Pairs: OrderAndStep[];\n    }\n  | {\n      Singleton: SizedContractionAndMethod;\n    };\n\nexport type OrderTreeNode =\n  | {\n      sourceType: \"Input\";\n      source: number;\n    }\n  | {\n      sourceType: \"Simplification\";\n      source: Simplification;\n    }\n  | {\n      sourceType: \"Result\";\n      source: OrderTree;\n    };\n\ninterface Simplification {\n  method: string;\n  einsum_string: string;\n  input: OrderTreeNode;\n}\n\ninterface OrderTree {\n  lhs: OrderTreeNode;\n  rhs: OrderTreeNode;\n  method: string;\n  simplified_einsum_string: string;\n}\n\nfunction treeifyStep(pairs: OrderAndStep[], intermediateNum: number): OrderTree {\n  const orderAndStep = pairs[intermediateNum];\n  const { lhs, rhs } = orderAndStep.operand_nums;\n  const {\n    method,\n    simplified_einsum_string,\n    lhs_simplification,\n    rhs_simplification\n  } = orderAndStep;\n\n  function resolve(num: OperandNumber): OrderTreeNode {\n    return isOperandNumberInput(num)\n      ? {\n          sourceType: \"Input\",\n          source: num.Input\n        }\n      : {\n          sourceType: \"Result\",\n          source: treeifyStep(pairs, num.IntermediateResult)\n        };\n  }\n\n  function getSimplification(\n    simplificationMethod: SimplificationMethod | null,\n    num: OperandNumber\n  ): OrderTreeNode {\n    return simplificationMethod !== null\n      ? {\n          sourceType: \"Simplification\",\n          source: {\n            method: simplificationMethod.method,\n            einsum_string: simplificationMethod.einsum_string,\n            input: resolve(num)\n          }\n        }\n      : resolve(num);\n  }\n\n  return {\n    lhs: getSimplification(lhs_simplification, lhs),\n    rhs: getSimplification(rhs_simplification, rhs),\n    method,\n    simplified_einsum_string\n  };\n}\n\nexport function treeifySteps(pairs: OrderAndStep[]): OrderTreeNode {\n  return {\n    sourceType: \"Result\",\n    source: treeifyStep(pairs, pairs.length - 1)\n  };\n}\n\nexport function zipSteps(path: EinsumPath): Result<OrderAndSteps> {\n  if (isPairsOrder(path.contraction_order) && isPairSteps(path.steps)) {\n    const pairContractions = path.steps.PairContractions;\n    return {\n      Ok: {\n        Pairs: path.contraction_order.Pairs.map((val, idx) => ({\n          ...val,\n          ...pairContractions[idx]\n        }))\n      }\n    };\n  } else if (isSingletonOrder(path.contraction_order) && isSingletonSteps(path.steps)) {\n    return {\n      Ok: {\n        Singleton: {\n          sized_contraction: path.contraction_order.Singleton,\n          method: path.steps.SingletonContraction.method\n        }\n      }\n    };\n  } else {\n    return { Err: \"Inconsistent order and steps\" };\n  }\n}\n","import React from \"react\";\nimport { OrderTreeNode } from \"../utils/showPath\";\n\ntype EinsumPathDetailsProps = {\n  level: number;\n  treeNode: OrderTreeNode;\n};\n\nconst EinsumPathDetails = (props: EinsumPathDetailsProps) => {\n  const { treeNode, level } = props;\n  let contents;\n  switch (treeNode.sourceType) {\n    case \"Input\":\n      contents = <div>Input #{treeNode.source}</div>;\n      break;\n    case \"Simplification\":\n      contents = (\n        <>\n          <div>{`${treeNode.source.method} (${treeNode.source.einsum_string})`}</div>\n          <EinsumPathDetails level={level + 1} treeNode={treeNode.source.input} />\n        </>\n      );\n      break;\n    case \"Result\":\n      contents = (\n        <>\n          <div>{`${treeNode.source.method} (${treeNode.source.simplified_einsum_string})`}</div>\n          <EinsumPathDetails level={level + 1} treeNode={treeNode.source.lhs} />\n          <EinsumPathDetails level={level + 1} treeNode={treeNode.source.rhs} />\n        </>\n      );\n      break;\n    default:\n      return <div>Unknown sourceType: {JSON.stringify(treeNode)}</div>;\n  }\n  return <div style={level > 0 ? { paddingLeft: \"1em\" } : {}}>{contents}</div>;\n};\n\nexport default React.memo(EinsumPathDetails);\n","import React from \"react\";\nimport { isErrorMessage, isEinsumPath } from \"../types/einsum_typeguards\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\nimport { zipSteps, OrderAndStep, treeifySteps } from \"../utils/showPath\";\nimport EinsumPathDetails from \"./EinsumPathDetails\";\n\ntype EinsumPathOutputProps = {\n  einsumPathJSON: string;\n};\n\nconst EinsumPathOutput = (props: EinsumPathOutputProps) => {\n  const { einsumPathJSON } = props;\n  const einsumPath = parseAndTypecheckJSON(einsumPathJSON, isEinsumPath, \"einsumPathAsJson\");\n  const steps = !isErrorMessage(einsumPath) && zipSteps(einsumPath.Ok);\n  const pairs =\n    steps &&\n    !isErrorMessage(steps) &&\n    steps.Ok &&\n    steps.Ok.hasOwnProperty(\"Pairs\") &&\n    (steps.Ok as { Pairs: OrderAndStep[] }).Pairs;\n  const tree = pairs && treeifySteps(pairs);\n  const output = isErrorMessage(einsumPath)\n    ? einsumPath\n    : {\n        Ok: (\n          <>\n            {tree && <EinsumPathDetails level={0} treeNode={tree} />}\n            {/* <div>Einsum Path: {JSON.stringify(zipSteps(einsumPath.Ok))}</div> */}\n          </>\n        )\n      };\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(EinsumPathOutput);\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype EinsumPathInputProps = {\n  optimizationMethod: string;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst EinsumPathInput = ({ optimizationMethod, dispatch }: EinsumPathInputProps) => {\n  const onMethodChange = (e: ChangeEvent<HTMLSelectElement>) => {\n    dispatch(appActions.updateOptimizationMethod(e.target.value));\n  };\n\n  return (\n    <InputColumn\n      prompt=\"Optimizer:\"\n      control={\n        <select onChange={onMethodChange} value={optimizationMethod}>\n          <option value=\"Naive\">Naive</option>\n          <option value=\"Reverse\">Reverse</option>\n        </select>\n      }\n    />\n  );\n};\n\nexport default React.memo(EinsumPathInput);\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport { einsumPathAsJson } from \"../pkg/einsum_wasm\";\nimport { parseShapeString } from \"../utils/parseShapeStrings\";\nimport { isErrorMessage } from \"../types/einsum_typeguards\";\nimport { parseDataString } from \"../utils/parseDataString\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\nimport EinsumPathOutput from \"./EinsumPathOutput\";\nimport EinsumPathInput from \"./EinsumPathInput\";\n\ntype PathProps = {\n  equation: string;\n  optimizationMethod: string;\n  visibleSizes: number;\n  operandShapes: string[];\n  operandContents: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst EinsumPath = ({\n  equation,\n  optimizationMethod,\n  visibleSizes,\n  operandShapes,\n  operandContents,\n  dispatch\n}: PathProps) => {\n  const shapes = operandShapes.slice(0, visibleSizes);\n  const contents = operandContents.slice(0, visibleSizes);\n  const operands = [];\n  for (let i = 0; i < Math.min(shapes.length, contents.length); i++) {\n    const shape = parseShapeString(shapes[i]);\n    const data = parseDataString(contents[i]);\n\n    if (!isErrorMessage(shape) && !isErrorMessage(data) && typeof data.Ok !== \"number\") {\n      operands.push({\n        shape: shape.Ok,\n        contents: data.Ok.flat(2 ** 16)\n      });\n    } else {\n      operands.push({\n        Err: `Array ${i} doesn't work`\n      });\n    }\n  }\n\n  const operandsJSON = JSON.stringify(operands);\n  const einsumPathJSON = einsumPathAsJson(\n    equation,\n    operandsJSON,\n    JSON.stringify(optimizationMethod)\n  );\n\n  return (\n    <InputOutputRow\n      input={<EinsumPathInput dispatch={dispatch} optimizationMethod={optimizationMethod} />}\n      output={<EinsumPathOutput einsumPathJSON={einsumPathJSON} />}\n    />\n  );\n};\n\nexport default React.memo(EinsumPath);\n","import React from \"react\";\nimport { AppState, AppAction } from \"../appstate/appState\";\nimport Equation from \"./Equation\";\nimport Shapes from \"./Shapes\";\nimport Computation from \"./Computation\";\nimport Presets from \"./Presets\";\nimport EinsumPath from \"./EinsumPath\";\n\ntype EinsumExplainerProps = {\n  appState: AppState;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst EinsumExplainer = ({ appState, dispatch }: EinsumExplainerProps) => {\n  const { equation, visibleSizes, operandStates, optimizationMethod } = appState;\n\n  return (\n    <div className=\"wrap container-fluid\">\n      <Presets dispatch={dispatch} />\n      <Equation equation={equation} dispatch={dispatch} />\n      <Shapes\n        equation={equation}\n        dispatch={dispatch}\n        visibleSizes={visibleSizes}\n        operandShapes={operandStates.map(x => x.shapeStr)}\n      />\n      <Computation\n        equation={equation}\n        dispatch={dispatch}\n        visibleSizes={visibleSizes}\n        operandContents={operandStates.map(x => x.contentsStr)}\n        operandShapes={operandStates.map(x => x.shapeStr)}\n      />\n      <EinsumPath\n        equation={equation}\n        dispatch={dispatch}\n        visibleSizes={visibleSizes}\n        optimizationMethod={optimizationMethod}\n        operandContents={operandStates.map(x => x.contentsStr)}\n        operandShapes={operandStates.map(x => x.shapeStr)}\n      />\n    </div>\n  );\n};\n\nexport default EinsumExplainer;\n","import React, { useReducer, useState } from \"react\";\nimport { reducer, initialState } from \"../appstate/appState\";\nimport EinsumExplainer from \"./EinsumExplainer\";\n\nimport \"./App.css\";\nimport \"flexboxgrid\";\n\nconst App = () => {\n  const [appState, dispatch] = useReducer(reducer, initialState);\n  const [, setReloadTime] = useState(Date.now());\n\n  if (module.hot) {\n    module.hot.accept(\"./EinsumExplainer\", () => {\n      setReloadTime(Date.now());\n    });\n  }\n\n  return <EinsumExplainer appState={appState} dispatch={dispatch} />;\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./components/App\";\nimport * as serviceWorker from \"./utils/serviceWorker\";\nimport init from \"./pkg/einsum_wasm.js\";\n\n(async function run() {\n  await init(\"./pkg/einsum_wasm_bg.wasm\");\n  ReactDOM.render(<App />, document.getElementById(\"root\"));\n})();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}