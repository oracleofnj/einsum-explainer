(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){e.exports=n(29)},20:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var r,a,i=n(6),o=n.n(i),c=n(11),u=n(0),s=n.n(u),l=n(12),p=n.n(l),f=(n(20),n(3)),d=n(4),m={},h=0,v=new TextEncoder("utf-8"),y=null;function g(){return null!==y&&y.buffer===r.memory.buffer||(y=new Uint8Array(r.memory.buffer)),y}a="function"===typeof v.encodeInto?function(e){for(var t=e.length,n=r.__wbindgen_malloc(t),a=0,i=g();a<e.length;a++){var o=e.charCodeAt(a);if(o>127)break;i[n+a]=o}if(a!==e.length){e=e.slice(a),n=r.__wbindgen_realloc(n,t,t=a+3*e.length);var c=g().subarray(n+a,n+t);a+=v.encodeInto(e,c).written}return h=a,n}:function(e){for(var t=e.length,n=r.__wbindgen_malloc(t),a=0,i=g();a<e.length;a++){var o=e.charCodeAt(a);if(o>127)break;i[n+a]=o}if(a!==e.length){var c=v.encode(e.slice(a));n=r.__wbindgen_realloc(n,t,t=a+c.length),g().set(c,n+a),a+=c.length}return h=a,n};var S=new TextDecoder("utf-8");function b(e,t){return S.decode(g().subarray(e,e+t))}var O=null;function w(){return null===O&&(O=r.__wbindgen_global_argument_ptr()),O}var E=null;function _(){return null!==E&&E.buffer===r.memory.buffer||(E=new Uint32Array(r.memory.buffer)),E}function A(e){var t=a(e),n=h,i=w();try{r.validateAsJson(i,t,n);var o=_(),c=o[i/4],u=o[i/4+1],s=b(c,u).slice();return r.__wbindgen_free(c,1*u),s}finally{r.__wbindgen_free(t,1*n)}}function k(e,t){var n=a(e),i=h,o=a(t),c=h,u=w();try{r.validateAndSizeFromShapesAsStringAsJson(u,n,i,o,c);var s=_(),l=s[u/4],p=s[u/4+1],f=b(l,p).slice();return r.__wbindgen_free(l,1*p),f}finally{r.__wbindgen_free(n,1*i),r.__wbindgen_free(o,1*c)}}function j(e,t){var n=a(e),i=h,o=a(t),c=h,u=w();try{r.einsumPathAsJson(u,n,i,o,c);var s=_(),l=s[u/4],p=s[u/4+1],f=b(l,p).slice();return r.__wbindgen_free(l,1*p),f}finally{r.__wbindgen_free(n,1*i),r.__wbindgen_free(o,1*c)}}function J(e,t){var n=a(e),i=h,o=a(t),c=h,u=w();try{r.slowEinsumAsJson(u,n,i,o,c);var s=_(),l=s[u/4],p=s[u/4+1],f=b(l,p).slice();return r.__wbindgen_free(l,1*p),f}finally{r.__wbindgen_free(n,1*i),r.__wbindgen_free(o,1*c)}}m.validateAsJson=A,m.validateAndSizeFromShapesAsStringAsJson=k,m.einsumPathAsJson=j,m.slowEinsumAsJson=J;var x=function e(t){var n,a={"./einsum_wasm":m};if(t instanceof URL||"string"===typeof t||t instanceof Request){var i=fetch(t);n="function"===typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(i,a).catch(function(e){return console.warn("`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e),i.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,a)})}):i.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,a)})}else n=WebAssembly.instantiate(t,a).then(function(e){return e instanceof WebAssembly.Instance?{instance:e,module:t}:e});return n.then(function(t){var n=t.instance,a=t.module;return r=n.exports,e.__wbindgen_wasm_module=a,r})},N=n(2);function q(e){return e.hasOwnProperty("Err")}function C(e){return e instanceof Array&&e.every(function(e){return"number"===typeof e})}function P(e){if("number"===typeof e)return{Ok:[]};var t=P(e[0]);if(q(t))return t;for(var n=function(n){var r=P(e[n]);return q(r)?{v:r}:t.Ok.every(function(e,t){return r.Ok[t]===e})?void 0:{v:{Err:"Array contains elements with different shapes"}}},r=1;r<e.length;r++){var a=n(r);if("object"===typeof a)return a.v}return{Ok:[e.length].concat(Object(N.a)(t.Ok))}}function z(e){return!!function e(t){if("number"===typeof t)return!0;if(!(t instanceof Array))return!1;if(C(t)&&0!==t.length)return!0;var n=t[0];if(!(n instanceof Array)||0===n.length)return!1;var r=n.length;return 0!==r&&t.every(function(t){return t instanceof Array&&t.length===r&&e(t)})}(e)&&!q(P(e))}function M(e){return e.hasOwnProperty("operand_indices")&&e.operand_indices instanceof Array&&e.operand_indices.every(function(e){return e instanceof Array})&&e.hasOwnProperty("output_indices")&&e.hasOwnProperty("summation_indices")}function F(e){return e.hasOwnProperty("contraction")&&M(e.contraction)&&e.hasOwnProperty("output_size")&&function(e){return Object.entries(e).every(function(e){var t=Object(f.a)(e,2);return t[0],"number"===typeof t[1]})}(e.output_size)}function T(e){return e.hasOwnProperty("shape")&&C(e.shape)&&e.hasOwnProperty("contents")&&C(e.contents)}function W(e,t,n){var r;try{r=JSON.parse(e)}catch(a){return{Err:"".concat(n," returned invalid JSON")}}return function(e,t,n){return function(e,t){return e.hasOwnProperty("Ok")&&t(e.Ok)}(e,t)?e:q(e)?e:n}(r,t,{Err:"".concat(n," returned valid JSON but of the wrong type")})}var B=function(e){return"updateEquation"===e.type&&e.hasOwnProperty("equation")&&"string"===typeof e.equation},V={type:"updateEquation",typeguard:B,actionCreator:function(e){return{type:"updateEquation",equation:e}},reducer:function(e,t){if(B(t)){var n=t.equation,r=e.visibleSizes,a=W(A(n),M,"validateAsJson");return q(a)||(r=a.Ok.operand_indices.length),Object(d.a)({},e,{visibleSizes:r,equation:t.equation})}throw new TypeError(JSON.stringify({action:t}))}};function I(e){var t,n=e.replace(/\(/g,"[").replace(/\)/g,"]");try{t=JSON.parse(n)}catch(r){return{Err:"Not a valid shape"}}return C(t)?{Ok:t}:{Err:"Not a valid shape"}}function R(e){return function e(t,n){switch(t.length){case 0:return n[0];case 1:return n.slice();default:for(var r=[],a=1,i=1;i<t.length;i++)a*=t[i];for(var o=0;o<t[0];o++)r.push(e(t.slice(1),n.slice(o*a,(o+1)*a)));return r}}(e.shape,e.contents)}var D="updateShape";function H(e){return e.type===D&&e.hasOwnProperty("index")&&"number"===typeof e.index&&e.hasOwnProperty("shape")&&"string"===typeof e.shape}function U(e,t){var n=1,r=!0,a=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){n*=o.value}}catch(l){a=!0,i=l}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}if(!(e instanceof Array))return Array(n).fill(0);for(var u=[],s=0;s<n;s++)"number"!==typeof e[s]?u.push(0):u.push(e[s]);return u}var L={type:D,typeguard:H,actionCreator:function(e,t){return{type:D,index:e,shape:t}},reducer:function(e,t){if(H(t)){var n=t.index,r=t.shape,a=I(r),i=e.operandStates[n],o=i.contentsVector,c=i.contentsStr;if(!q(a)){var u=R({shape:a.Ok,contents:U(o,a.Ok)});c=JSON.stringify(u)}return Object(d.a)({},e,{operandStates:[].concat(Object(N.a)(e.operandStates.slice(0,n)),[Object(d.a)({},i,{shapeStr:r,contentsStr:c,contentsVector:o})],Object(N.a)(e.operandStates.slice(n+1)))})}throw new TypeError(JSON.stringify({reducer:D,action:t}))}};function $(e){var t,n=e.replace(/\(/g,"[").replace(/\)/g,"]");try{t=JSON.parse(n)}catch(r){return{Err:"Not a valid ndArray"}}return z(t)?{Ok:t}:{Err:"Not a valid ndArray"}}var G="updateContents";function K(e){return e.type===G&&e.hasOwnProperty("index")&&"number"===typeof e.index&&e.hasOwnProperty("contents")&&"string"===typeof e.contents}var Q={type:G,typeguard:K,actionCreator:function(e,t){return{type:G,index:e,contents:t}},reducer:function(e,t){if(K(t)){var n=t.index,r=t.contents,a=$(r),i=e.operandStates[n],o=i.shapeStr,c=i.contentsVector;if(!q(a)){var u=P(a.Ok);if(q(u))throw new Error("This shouldn't be possible");o=JSON.stringify(u.Ok).replace(/\[/g,"(").replace(/\]/g,")"),c=a.Ok.flat(Math.pow(2,16))}return Object(d.a)({},e,{operandStates:[].concat(Object(N.a)(e.operandStates.slice(0,n)),[Object(d.a)({},i,{shapeStr:o,contentsVector:c,contentsStr:r})],Object(N.a)(e.operandStates.slice(n+1)))})}throw new TypeError(JSON.stringify({reducer:G,action:t}))}};function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===e.length)return{shapeStr:"()",contentsStr:"[]",contentsVector:[]};var r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===n)throw new Error("range: step must not be zero");void 0===t&&(t=e,e=0);for(var r=[],a=e;a<t;)r.push(a),a+=n;return r}(t,t+n*e.reduce(function(e,t){return t*e},1),n),a=R({shape:e,contents:r});return{shapeStr:JSON.stringify(e).replace(/\[/g,"(").replace(/\]/g,")"),contentsStr:JSON.stringify(a),contentsVector:r}}function Y(e){var t=(0,e.presetFn)(),n=t.equation,r=t.operandStates,a=r.length;return{equation:n,visibleSizes:a,operandStates:[].concat(Object(N.a)(r),Object(N.a)(Array(256-a).fill(X([]))))}}var Z={matrixMultiplication:{description:"Matrix Multiplication",presetFn:function(){return{equation:"ij,jk->ik",operandStates:[X([2,3],0,1),X([3,5],0,10)]}}},matrixTransposition:{description:"Matrix Transposition (Implicit)",presetFn:function(){return{equation:"ji",operandStates:[X([2,3],0,1)]}}},sum2D:{description:"Sum All Elements (2D)",presetFn:function(){return{equation:"ij->",operandStates:[X([2,3],0,1)]}}},columnSum:{description:"Sum Each Column",presetFn:function(){return{equation:"ij->j",operandStates:[X([2,3],0,1)]}}},rowSum:{description:"Sum Each Row",presetFn:function(){return{equation:"ij->i",operandStates:[X([2,3],0,1)]}}},getDiagonal:{description:"Take the Diagonal",presetFn:function(){return{equation:"ii->i",operandStates:[X([3,3],0,1)]}}},matrixVectorMultiplication:{description:"Matrix-Vector Multiplication",presetFn:function(){return{equation:"ij,j->i",operandStates:[X([2,3],0,1),X([3],0,10)]}}},outerProduct:{description:"Outer Product",presetFn:function(){return{equation:"i,j->ij",operandStates:[X([3],0,1),X([4],10,10)]}}},batchMM1:{description:"Batch Matrix Multiplication (single RHS)",presetFn:function(){return{equation:"nij,jk->nik",operandStates:[X([4,2,5],0,1),X([5,3],0,10)]}}},batchMM2:{description:"Batch Matrix Multiplication (multiple RHS)",presetFn:function(){return{equation:"nij,njk->nik",operandStates:[X([4,2,5],0,1),X([4,5,3],0,10)]}}},tensorContraction:{description:"Tensor Contraction",presetFn:function(){return{equation:"pqrs,tuqvr->pstuv",operandStates:[X([2,3,5,7],0,1),X([11,13,3,17,5],0,10)]}}},bilinearTransformation:{description:"Bilinear Transformation",presetFn:function(){return{equation:"ik,jkl,il->ij",operandStates:[X([2,3],0,1),X([5,3,7],0,10),X([2,7],0,100)]}}}},ee=function(e){return"loadPreset"===e.type&&"string"===typeof e.preset&&Z.hasOwnProperty(e.preset)},te={type:"loadPreset",typeguard:ee,actionCreator:function(e){return{type:"loadPreset",preset:e}},reducer:function(e,t){if(ee(t))return Y(Z[t.preset]);throw new TypeError(JSON.stringify({action:t}))}},ne=Y(Z.matrixMultiplication),re={updateEquation:V.actionCreator,updateShape:L.actionCreator,updateContents:Q.actionCreator,loadPreset:te.actionCreator},ae=function(e){var t={};return e.forEach(function(e){if(t[e.type])throw new Error("Multiple declarations for ".concat(e.type));t[e.type]=e.reducer}),function(e,n){return t[n.type](e,n)}}([te,V,L,Q]);function ie(e){var t=e.prompt,n=e.control;return s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-4 col-lg-3"},t),s.a.createElement("div",{className:"col-xs-7 col-lg-9"},n))}var oe=s.a.memo(function(e){var t=e.equation,n=e.dispatch;return s.a.createElement(ie,{prompt:"Equation:",control:s.a.createElement("input",{type:"text",onChange:function(e){n(re.updateEquation(e.target.value))},value:t})})}),ce=n(13);n(21);var ue=function(e){var t="Out_{".concat(e.output_indices.join(","),"}"),n=e.summation_indices.map(function(e){return"\\sum_".concat(e)}).join(" "),r=e.operand_indices.map(function(e,t){var n="A".charCodeAt(0),r=String.fromCharCode(n+t),a=e.join(",");return"".concat(r,"_{").concat(a,"}")}).join(" ");return"".concat(t," = ").concat(n," ").concat(r)},se=n(7),le=n(9);function pe(e){var t=e.output;return s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-2 col-xs-offset-2 col-md-offset-0 col-md-1"},q(t)?s.a.createElement(se.a,{title:"Something went wrong!",icon:le.b,size:"2x",color:"orangered"}):s.a.createElement(se.a,{title:"Everything is cool!",icon:le.a,size:"2x",color:"darkgreen"})),s.a.createElement("div",{className:"col-xs-8 col-md-11"},q(t)?t.Err:t.Ok))}var fe=s.a.memo(function(e){var t=W(e.explanationJSON,M,"validateAsJson"),n=q(t)?t:{Ok:s.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(ce.renderToString)(ue(t.Ok))}})};return s.a.createElement(pe,{output:n})});function de(e){var t=e.input,n=e.output;return s.a.createElement("div",{className:"row",style:{paddingTop:"1em",paddingBottom:"1em"}},s.a.createElement("div",{className:"col-xs-12 col-md-6"},t),s.a.createElement("div",{className:"col-xs-12 col-md-6"},n))}var me=s.a.memo(function(e){var t=e.equation,n=e.dispatch,r=A(t);return s.a.createElement(de,{input:s.a.createElement(oe,{equation:t,dispatch:n}),output:s.a.createElement(fe,{explanationJSON:r})})}),he=s.a.memo(function(e){var t,n=e.equationJSON,r=e.sizedExplanationJSON,a=W(n,M,"validateAsJson"),i=W(r,F,"validateAndSizeFromShapesAsStringAsJson");if(q(i))t=i;else if(q(a))t=a;else{var o=a.Ok,c=i.Ok.output_size;t={Ok:s.a.createElement("div",null,s.a.createElement("div",null,"Output size: [",o.output_indices.join(", "),"] ="," ",JSON.stringify(o.output_indices.map(function(e){return c[e]}))),s.a.createElement("div",null,"Summation index lengths:"," ",o.summation_indices.map(function(e){return"".concat(e,": ").concat(c[e])}).join("; ")))}}return s.a.createElement(pe,{output:t})}),ve=s.a.memo(function(e){for(var t=e.operandShapes,n=e.visibleSizes,r=e.dispatch,a=[],i=0;i<n;i++)a.push(i<t.length?t[i]:"[]");var o=function(e){return function(t){r(re.updateShape(e,t.target.value))}};return s.a.createElement(s.a.Fragment,null,a.map(function(e,t){return s.a.createElement(ie,{key:t,prompt:"Shape of ".concat(String.fromCharCode(t+"A".charCodeAt(0)),":"),control:s.a.createElement("input",{type:"text",onChange:o(t),value:e})})}))}),ye=s.a.memo(function(e){var t,n=e.equation,r=e.visibleSizes,a=e.operandShapes,i=e.dispatch,o=A(n),c=a.slice(0,r).map(I);return t=c.some(q)?JSON.stringify({Err:JSON.stringify(c.map(function(e,t){return{val:e,idx:t}}).filter(function(e){return q(e.val)}).map(function(e){var t=e.val;return{Tensor:e.idx,Error:t.Err}}))}):k(n,JSON.stringify(c.map(function(e){return e.Ok}))),s.a.createElement(de,{input:s.a.createElement(ve,{dispatch:i,visibleSizes:r,operandShapes:a}),output:s.a.createElement(he,{sizedExplanationJSON:t,equationJSON:o})})}),ge=s.a.memo(function(e){var t=e.computationOutputJSON,n=e.einsumPathJSON,r=W(t,T,"slowEinsumAsJson"),a=q(r)?r:{Ok:s.a.createElement(s.a.Fragment,null,"Einsum Result:"," ",s.a.createElement("div",null,JSON.stringify(R(r.Ok),null,2)),s.a.createElement("div",null,"Einsum Path: ",n))};return s.a.createElement(pe,{output:a})}),Se=s.a.memo(function(e){for(var t=e.operandContents,n=e.visibleSizes,r=e.dispatch,a=[],i=0;i<n;i++)a.push(i<t.length?t[i]:"[]");var o=function(e){return function(t){r(re.updateContents(e,t.target.value))}};return s.a.createElement(s.a.Fragment,null,a.map(function(e,t){return s.a.createElement(ie,{key:t,prompt:"Contents of ".concat(String.fromCharCode(t+"A".charCodeAt(0)),":"),control:s.a.createElement("input",{type:"text",onChange:o(t),value:e})})}))}),be=s.a.memo(function(e){for(var t=e.equation,n=e.visibleSizes,r=e.operandShapes,a=e.operandContents,i=e.dispatch,o=r.slice(0,n),c=a.slice(0,n),u=[],l=0;l<Math.min(o.length,c.length);l++){var p=I(o[l]),f=$(c[l]);q(p)||q(f)||"number"===typeof f.Ok?u.push({Err:"Array ".concat(l," doesn't work")}):u.push({shape:p.Ok,contents:f.Ok.flat(Math.pow(2,16))})}var d=JSON.stringify(u),m=j(t,d),h=J(t,d);return s.a.createElement(de,{input:s.a.createElement(Se,{dispatch:i,visibleSizes:n,operandContents:a}),output:s.a.createElement(ge,{computationOutputJSON:h,einsumPathJSON:m})})}),Oe=s.a.memo(function(e){var t=e.dispatch,n=Object.entries(Z),r=Object(u.useState)(n[0][0]),a=Object(f.a)(r,2),i=a[0],o=a[1];return s.a.createElement(de,{input:s.a.createElement(ie,{prompt:"Try one:",control:s.a.createElement("select",{value:i,onChange:function(e){o(e.target.value),t(re.loadPreset(e.target.value))}},n.map(function(e){var t=Object(f.a)(e,2),n=t[0],r=t[1];return s.a.createElement("option",{key:n,value:n},r.description)}))}),output:s.a.createElement(s.a.Fragment,null)})}),we=function(e){var t=e.appState,n=e.dispatch,r=t.equation,a=t.visibleSizes,i=t.operandStates;return s.a.createElement("div",{className:"wrap container-fluid"},s.a.createElement(Oe,{dispatch:n}),s.a.createElement(me,{equation:r,dispatch:n}),s.a.createElement(ye,{equation:r,dispatch:n,visibleSizes:a,operandShapes:i.map(function(e){return e.shapeStr})}),s.a.createElement(be,{equation:r,dispatch:n,visibleSizes:a,operandContents:i.map(function(e){return e.contentsStr}),operandShapes:i.map(function(e){return e.shapeStr})}))},Ee=(n(27),n(28),function(){var e=Object(u.useReducer)(ae,ne),t=Object(f.a)(e,2),n=t[0],r=t[1],a=Object(u.useState)(Date.now());Object(f.a)(a,2)[1];return s.a.createElement(we,{appState:n,dispatch:r})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=Object(c.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("./pkg/einsum_wasm_bg.wasm");case 2:p.a.render(s.a.createElement(Ee,null),document.getElementById("root"));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.1da7fecf.chunk.js.map