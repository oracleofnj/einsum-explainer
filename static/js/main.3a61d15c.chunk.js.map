{"version":3,"sources":["pkg/einsum.js","types/einsum_typeguards.ts","utils/parseAndTypecheckJSON.ts","appstate/ducks/updateEquation.ts","utils/parseShapeStrings.ts","utils/parseOutputString.ts","appstate/ducks/updateShape.ts","utils/parseDataString.ts","appstate/ducks/updateContents.ts","appstate/makeOperand.ts","utils/range.ts","appstate/presets.ts","appstate/ducks/loadPreset.ts","appstate/appState.ts","appstate/makeReducer.ts","components/layout/InputColumn.tsx","components/EquationInput.tsx","utils/makeLatexString.ts","components/layout/OutputColumn.tsx","components/EquationOutput.tsx","components/layout/InputOutputRow.tsx","components/Equation.tsx","components/AxisLengthsOutput.tsx","components/ShapesInput.tsx","components/Shapes.tsx","components/ComputationOutput.tsx","components/ContentsInput.tsx","components/Computation.tsx","components/Presets.tsx","components/EinsumExplainer.tsx","components/App.tsx","utils/serviceWorker.js","index.js"],"names":["wasm","passStringToWasm","__exports","WASM_VECTOR_LEN","cachedTextEncoder","TextEncoder","cachegetUint8Memory","getUint8Memory","buffer","memory","Uint8Array","encodeInto","arg","size","length","ptr","__wbindgen_malloc","writeOffset","view","subarray","_cachedTextEncoder$en","read","written","substring","__wbindgen_realloc","buf","encode","set","cachedTextDecoder","TextDecoder","getStringFromWasm","len","decode","cachedGlobalArgumentPtr","globalArgumentPtr","__wbindgen_global_argument_ptr","cachegetUint32Memory","getUint32Memory","Uint32Array","validateAsJson","input_string","ptr0","len0","retptr","mem","rustptr","rustlen","realRet","slice","__wbindgen_free","validateAndSizeFromShapesAsStringAsJson","operand_shapes","ptr1","len1","slowEinsumAsJson","flattened_operands_as_string","heap","Array","fill","undefined","push","heap_next","__wbindgen_object_drop_ref","i","idx","init","module","result","imports","./einsum","URL","Request","response","fetch","WebAssembly","instantiateStreaming","catch","e","console","warn","then","r","arrayBuffer","bytes","instantiate","Instance","instance","_ref","exports","__wbindgen_wasm_module","isErrorMessage","hasOwnProperty","isNumberArray","every","x","getShape","arr","Ok","innerShape","_loop","nextShape","v","val","ix","Err","_ret","concat","Object","toConsumableArray","isNDArray","isProbablyNDArray","first","isContraction","operand_indices","isSizedContraction","contraction","entries","_ref2","slicedToArray","isOutputSize","output_size","isFlattenedOperand","shape","contents","parseAndTypecheckJSON","str","typeguard","problematicFunctionName","obj","JSON","parse","_unused","err","isOk","enforce","action","type","equation","updateEquation","actionCreator","reducer","state","visibleSizes","einsumExplanation","objectSpread","TypeError","stringify","parseShapeString","shapeString","bracketedShapeString","replace","parseOutput","output","unflatten","stride","UPDATE_SHAPE","index","getContents","totalLength","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","value","return","ret","updateShape","data","oldOperand","operandStates","contentsVector","contentsStr","newNDArray","shapeStr","parseDataString","dataString","bracketedDataString","UPDATE_CONTENTS","updateContents","Error","flat","Math","pow","makeOperand","start","arguments","step","stop","range","reduce","product","ndArray","getState","_presetFn","presetFn","presets","matrixMultiplication","description","matrixTransposition","sum2D","columnSum","rowSum","getDiagonal","matrixVectorMultiplication","outerProduct","batchMM1","batchMM2","tensorContraction","bilinearTransformation","preset","loadPreset","initialState","appActions","updateEquationDuck","updateShapeDuck","updateContentsDuck","loadPresetDuck","ducks","appReducers","forEach","duck","makeReducer","InputColumn","prompt","control","react_default","a","createElement","className","React","memo","dispatch","onChange","target","makeLatexString","outputMatrix","output_indices","join","summationSymbols","summation_indices","map","inputMatrices","indices","n","asciiA","charCodeAt","matrixName","String","fromCharCode","subscripts","split","OutputColumn","index_es","title","icon","faTimesCircle","color","faCheckCircle","props","explanation","explanationJSON","dangerouslySetInnerHTML","__html","renderToString","InputOutputRow","input","style","paddingTop","paddingBottom","equationJSON","components_EquationInput","components_EquationOutput","sizedExplanationJSON","sizedExplanation","outputMap","operandShapes","shapes","makeOnShapeChange","Fragment","key","shapeArrays","some","filter","_ref3","Tensor","components_ShapesInput","components_AxisLengthsOutput","computationOutput","computationOutputJSON","operandContents","makeOnContentsChange","operands","min","components_ContentsInput","components_ComputationOutput","presetChoices","_useState","useState","_useState2","selectedPreset","setSelectedPreset","name","EinsumExplainer","appState","components_Presets","components_Equation","components_Shapes","components_Computation","App","_useReducer","useReducer","_useReducer2","Date","now","components_EinsumExplainer","Boolean","window","location","hostname","match","_run","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","ReactDOM","render","src_components_App","document","getElementById","apply","this","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.3a61d15c.chunk.js","sourcesContent":["\nconst __exports = {};\nlet wasm;\n\nlet WASM_VECTOR_LEN = 0;\n\nlet cachedTextEncoder = new TextEncoder('utf-8');\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nlet passStringToWasm;\nif (typeof cachedTextEncoder.encodeInto === 'function') {\n    passStringToWasm = function(arg) {\n\n        let size = arg.length;\n        let ptr = wasm.__wbindgen_malloc(size);\n        let writeOffset = 0;\n        while (true) {\n            const view = getUint8Memory().subarray(ptr + writeOffset, ptr + size);\n            const { read, written } = cachedTextEncoder.encodeInto(arg, view);\n            writeOffset += written;\n            if (read === arg.length) {\n                break;\n            }\n            arg = arg.substring(read);\n            ptr = wasm.__wbindgen_realloc(ptr, size, size += arg.length * 3);\n        }\n        WASM_VECTOR_LEN = writeOffset;\n        return ptr;\n    };\n} else {\n    passStringToWasm = function(arg) {\n\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = wasm.__wbindgen_malloc(buf.length);\n        getUint8Memory().set(buf, ptr);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    };\n}\n\nlet cachedTextDecoder = new TextDecoder('utf-8');\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n\nlet cachedGlobalArgumentPtr = null;\nfunction globalArgumentPtr() {\n    if (cachedGlobalArgumentPtr === null) {\n        cachedGlobalArgumentPtr = wasm.__wbindgen_global_argument_ptr();\n    }\n    return cachedGlobalArgumentPtr;\n}\n\nlet cachegetUint32Memory = null;\nfunction getUint32Memory() {\n    if (cachegetUint32Memory === null || cachegetUint32Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint32Memory = new Uint32Array(wasm.memory.buffer);\n    }\n    return cachegetUint32Memory;\n}\n/**\n* @param {string} input_string\n* @returns {string}\n*/\nexport function validateAsJson(input_string) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.validateAsJson(retptr, ptr0, len0);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n\n    }\n\n}\n\n__exports.validateAsJson = validateAsJson;\n\n/**\n* @param {string} input_string\n* @param {string} operand_shapes\n* @returns {string}\n*/\nexport function validateAndSizeFromShapesAsStringAsJson(input_string, operand_shapes) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const ptr1 = passStringToWasm(operand_shapes);\n    const len1 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.validateAndSizeFromShapesAsStringAsJson(retptr, ptr0, len0, ptr1, len1);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n        wasm.__wbindgen_free(ptr1, len1 * 1);\n\n    }\n\n}\n\n__exports.validateAndSizeFromShapesAsStringAsJson = validateAndSizeFromShapesAsStringAsJson;\n\n/**\n* @param {string} input_string\n* @param {string} flattened_operands_as_string\n* @returns {string}\n*/\nexport function slowEinsumAsJson(input_string, flattened_operands_as_string) {\n    const ptr0 = passStringToWasm(input_string);\n    const len0 = WASM_VECTOR_LEN;\n    const ptr1 = passStringToWasm(flattened_operands_as_string);\n    const len1 = WASM_VECTOR_LEN;\n    const retptr = globalArgumentPtr();\n    try {\n        wasm.slowEinsumAsJson(retptr, ptr0, len0, ptr1, len1);\n        const mem = getUint32Memory();\n        const rustptr = mem[retptr / 4];\n        const rustlen = mem[retptr / 4 + 1];\n\n        const realRet = getStringFromWasm(rustptr, rustlen).slice();\n        wasm.__wbindgen_free(rustptr, rustlen * 1);\n        return realRet;\n\n\n    } finally {\n        wasm.__wbindgen_free(ptr0, len0 * 1);\n        wasm.__wbindgen_free(ptr1, len1 * 1);\n\n    }\n\n}\n\n__exports.slowEinsumAsJson = slowEinsumAsJson;\n\nconst heap = new Array(32);\n\nheap.fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction __wbindgen_object_drop_ref(i) { dropObject(i); }\n\n__exports.__wbindgen_object_drop_ref = __wbindgen_object_drop_ref;\n\nfunction init(module) {\n    let result;\n    const imports = { './einsum': __exports };\n    if (module instanceof URL || typeof module === 'string' || module instanceof Request) {\n\n        const response = fetch(module);\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            result = WebAssembly.instantiateStreaming(response, imports)\n            .catch(e => {\n                console.warn(\"`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n                return response\n                .then(r => r.arrayBuffer())\n                .then(bytes => WebAssembly.instantiate(bytes, imports));\n            });\n        } else {\n            result = response\n            .then(r => r.arrayBuffer())\n            .then(bytes => WebAssembly.instantiate(bytes, imports));\n        }\n    } else {\n\n        result = WebAssembly.instantiate(module, imports)\n        .then(result => {\n            if (result instanceof WebAssembly.Instance) {\n                return { instance: result, module };\n            } else {\n                return result;\n            }\n        });\n    }\n    return result.then(({instance, module}) => {\n        wasm = instance.exports;\n        init.__wbindgen_wasm_module = module;\n\n        return wasm;\n    });\n}\n\nexport default init;\n\n","export type ErrorMessage = {\n  Err: string;\n};\n\nexport function isErrorMessage(r: any): r is ErrorMessage {\n  return (r as object).hasOwnProperty(\"Err\");\n}\n\nexport type Result<T> = { Ok: T } | ErrorMessage;\n\nexport function isOk<T>(r: any, typeguard: (obj: any) => obj is T): r is Result<T> {\n  return (r as object).hasOwnProperty(\"Ok\") && typeguard((r as { Ok: T }).Ok);\n}\n\nexport function enforce<T>(\n  obj: any,\n  typeguard: (obj: any) => obj is T,\n  err: ErrorMessage\n): Result<T> {\n  if (isOk(obj, typeguard)) {\n    return obj;\n  } else if (isErrorMessage(obj)) {\n    return obj;\n  } else {\n    return err;\n  }\n}\n\nexport function isNumberArray(r: any): r is number[] {\n  return r instanceof Array && r.every(x => typeof x === \"number\");\n}\n\nexport type NDArray = number | NDArrayArray;\n\ninterface NDArrayArray extends Array<NDArray> {}\n\nfunction isProbablyNDArray(r: any): r is NDArray {\n  if (typeof r === \"number\") {\n    return true;\n  }\n  if (!(r instanceof Array)) {\n    return false;\n  }\n  if (isNumberArray(r) && r.length !== 0) {\n    return true;\n  }\n  const first = r[0];\n  if (!(first instanceof Array) || first.length === 0) {\n    return false;\n  }\n  const len = first.length;\n  return (\n    len !== 0 && r.every(x => x instanceof Array && x.length === len && isProbablyNDArray(x))\n  );\n}\n\nexport function getShape(arr: NDArray): Result<number[]> {\n  if (typeof arr === \"number\") {\n    return { Ok: [] };\n  }\n  const innerShape = getShape(arr[0]);\n  if (isErrorMessage(innerShape)) {\n    return innerShape;\n  }\n  for (let i = 1; i < arr.length; i++) {\n    const nextShape = getShape(arr[i]);\n    if (isErrorMessage(nextShape)) {\n      return nextShape;\n    }\n    if (!innerShape.Ok.every((val, ix) => nextShape.Ok[ix] === val)) {\n      return {\n        Err: \"Array contains elements with different shapes\"\n      };\n    }\n  }\n  return { Ok: [arr.length, ...innerShape.Ok] };\n}\n\nexport function isNDArray(r: any): r is NDArray {\n  if (!isProbablyNDArray(r)) {\n    return false;\n  }\n  const shape = getShape(r);\n  return !isErrorMessage(shape);\n}\n\nexport type Contraction = {\n  operand_indices: string[];\n  output_indices: string[];\n  summation_indices: string[];\n};\n\nexport function isContraction(r: object): r is Contraction {\n  return (\n    r.hasOwnProperty(\"operand_indices\") &&\n    (r as Contraction).operand_indices instanceof Array &&\n    r.hasOwnProperty(\"output_indices\") &&\n    r.hasOwnProperty(\"summation_indices\")\n  );\n}\n\nexport type OutputSize = { [key: string]: number };\n\nexport function isOutputSize(r: any): r is OutputSize {\n  return Object.entries(r as object).every(([_, val]) => typeof val === \"number\");\n}\n\nexport type SizedContraction = {\n  contraction: Contraction;\n  output_size: OutputSize;\n};\n\nexport function isSizedContraction(r: object): r is SizedContraction {\n  return (\n    r.hasOwnProperty(\"contraction\") &&\n    isContraction((r as SizedContraction).contraction) &&\n    r.hasOwnProperty(\"output_size\") &&\n    isOutputSize((r as SizedContraction).output_size)\n  );\n}\n\nexport type FlattenedOperand = {\n  shape: number[];\n  contents: number[];\n};\n\nexport function isFlattenedOperand(r: object): r is FlattenedOperand {\n  return (\n    r.hasOwnProperty(\"shape\") &&\n    isNumberArray((r as FlattenedOperand).shape) &&\n    r.hasOwnProperty(\"contents\") &&\n    isNumberArray((r as FlattenedOperand).contents)\n  );\n}\n","import { Result, enforce } from \"../types/einsum_typeguards\";\n\nexport default function parseAndTypecheckJSON<T>(\n  str: string,\n  typeguard: (r: any) => r is T,\n  problematicFunctionName: string\n): Result<T> {\n  let obj;\n  try {\n    obj = JSON.parse(str);\n  } catch {\n    return {\n      Err: `${problematicFunctionName} returned invalid JSON`\n    };\n  }\n  return enforce(obj, typeguard, {\n    Err: `${problematicFunctionName} returned valid JSON but of the wrong type`\n  });\n}\n","import { validateAsJson } from \"../../pkg/einsum\";\nimport { isContraction, isErrorMessage } from \"../../types/einsum_typeguards\";\nimport { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport parseAndTypecheckJSON from \"../../utils/parseAndTypecheckJSON\";\n\nconst UPDATE_EQUATION = \"updateEquation\";\n\nexport interface UpdateEquationAction extends AnyAction {\n  equation: string;\n}\n\nconst typeguard = (action: AppAction): action is UpdateEquationAction =>\n  action.type === UPDATE_EQUATION &&\n  action.hasOwnProperty(\"equation\") &&\n  typeof (action as UpdateEquationAction).equation === \"string\";\n\nconst actionCreator = (equation: string): UpdateEquationAction => ({\n  type: UPDATE_EQUATION,\n  equation\n});\n\nconst reducer = (state: AppState, action: AppAction): AppState => {\n  if (typeguard(action)) {\n    const { equation } = action;\n    let { visibleSizes } = state;\n\n    const einsumExplanation = parseAndTypecheckJSON(\n      validateAsJson(equation),\n      isContraction,\n      \"validateAsJson\"\n    );\n    if (!isErrorMessage(einsumExplanation)) {\n      visibleSizes = einsumExplanation.Ok.operand_indices.length;\n    }\n\n    return {\n      ...state,\n      visibleSizes,\n      equation: (action as UpdateEquationAction).equation\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ action }));\n  }\n};\n\nexport default {\n  type: UPDATE_EQUATION,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import { Result, isNumberArray } from \"../types/einsum_typeguards\";\n\nfunction parseShapeString(shapeString: string): Result<number[]> {\n  const bracketedShapeString = shapeString.replace(/\\(/g, \"[\").replace(/\\)/g, \"]\");\n  let obj;\n  try {\n    obj = JSON.parse(bracketedShapeString);\n  } catch {\n    return {\n      Err: \"Not a valid shape\"\n    };\n  }\n  return isNumberArray(obj) ? { Ok: obj } : { Err: \"Not a valid shape\" };\n}\n\nexport { parseShapeString };\n","import { FlattenedOperand, NDArray } from \"../types/einsum_typeguards\";\n\nfunction unflatten(shape: number[], contents: number[]): NDArray {\n  switch (shape.length) {\n    case 0:\n      return contents[0];\n    case 1:\n      return contents.slice();\n    default:\n      const result: NDArray = [];\n      let stride = 1;\n      for (let i = 1; i < shape.length; i++) {\n        stride *= shape[i];\n      }\n      for (let i = 0; i < shape[0]; i++) {\n        result.push(unflatten(shape.slice(1), contents.slice(i * stride, (i + 1) * stride)));\n      }\n      return result;\n  }\n}\n\nexport default function parseOutput(output: FlattenedOperand): NDArray {\n  const { shape, contents } = output;\n  return unflatten(shape, contents);\n}\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport { parseShapeString } from \"../../utils/parseShapeStrings\";\nimport { isErrorMessage } from \"../../types/einsum_typeguards\";\nimport parseOutput from \"../../utils/parseOutputString\";\n\nexport interface UpdateShapeAction extends AnyAction {\n  index: number;\n  shape: string;\n}\n\nconst UPDATE_SHAPE = \"updateShape\";\nfunction typeguard(action: AppAction): action is UpdateShapeAction {\n  return (\n    action.type === UPDATE_SHAPE &&\n    action.hasOwnProperty(\"index\") &&\n    typeof (action as UpdateShapeAction).index === \"number\" &&\n    action.hasOwnProperty(\"shape\") &&\n    typeof (action as UpdateShapeAction).shape === \"string\"\n  );\n}\n\nfunction actionCreator(index: number, shape: string): UpdateShapeAction {\n  return {\n    type: UPDATE_SHAPE,\n    index,\n    shape\n  };\n}\n\nfunction getContents(v: number[], shape: number[]) {\n  let totalLength = 1;\n  for (const s of shape) {\n    totalLength *= s;\n  }\n  if (!(v instanceof Array)) {\n    return Array(totalLength).fill(0);\n  }\n  const ret = [];\n  for (let i = 0; i < totalLength; i++) {\n    if (typeof v[i] !== \"number\") {\n      ret.push(0);\n    } else {\n      ret.push(v[i]);\n    }\n  }\n  return ret;\n}\n\nfunction reducer(state: AppState, action: AppAction): AppState {\n  if (typeguard(action)) {\n    const { index, shape } = action;\n    const data = parseShapeString(shape);\n    const oldOperand = state.operandStates[index];\n    const { contentsVector } = oldOperand;\n    let { contentsStr } = oldOperand;\n    if (!isErrorMessage(data)) {\n      const newNDArray = parseOutput({\n        shape: data.Ok,\n        contents: getContents(contentsVector, data.Ok)\n      });\n      contentsStr = JSON.stringify(newNDArray);\n    }\n\n    return {\n      ...state,\n      operandStates: [\n        ...state.operandStates.slice(0, index),\n        {\n          ...oldOperand,\n          shapeStr: shape,\n          contentsStr,\n          contentsVector\n        },\n        ...state.operandStates.slice(index + 1)\n      ]\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ reducer: UPDATE_SHAPE, action }));\n  }\n}\n\nexport default {\n  type: UPDATE_SHAPE,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import { Result, isNDArray, NDArray } from \"../types/einsum_typeguards\";\n\nfunction parseDataString(dataString: string): Result<NDArray> {\n  const bracketedDataString = dataString.replace(/\\(/g, \"[\").replace(/\\)/g, \"]\");\n  let obj;\n  try {\n    obj = JSON.parse(bracketedDataString);\n  } catch {\n    return {\n      Err: \"Not a valid ndArray\"\n    };\n  }\n  return isNDArray(obj) ? { Ok: obj } : { Err: \"Not a valid ndArray\" };\n}\n\nexport { parseDataString };\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport { parseDataString } from \"../../utils/parseDataString\";\nimport { isErrorMessage, getShape } from \"../../types/einsum_typeguards\";\n\nexport interface UpdateContentsAction extends AnyAction {\n  index: number;\n  contents: string;\n}\n\nconst UPDATE_CONTENTS = \"updateContents\";\nfunction typeguard(action: AppAction): action is UpdateContentsAction {\n  return (\n    action.type === UPDATE_CONTENTS &&\n    action.hasOwnProperty(\"index\") &&\n    typeof (action as UpdateContentsAction).index === \"number\" &&\n    action.hasOwnProperty(\"contents\") &&\n    typeof (action as UpdateContentsAction).contents === \"string\"\n  );\n}\n\nfunction actionCreator(index: number, contents: string): UpdateContentsAction {\n  return {\n    type: UPDATE_CONTENTS,\n    index,\n    contents\n  };\n}\n\nfunction reducer(state: AppState, action: AppAction): AppState {\n  if (typeguard(action)) {\n    const { index, contents } = action;\n    const data = parseDataString(contents);\n    const oldOperand = state.operandStates[index];\n    let { shapeStr, contentsVector } = oldOperand;\n    if (!isErrorMessage(data)) {\n      const shape = getShape(data.Ok);\n      if (isErrorMessage(shape)) {\n        throw new Error(\"This shouldn't be possible\");\n      }\n      shapeStr = JSON.stringify(shape.Ok)\n        .replace(/\\[/g, \"(\")\n        .replace(/\\]/g, \")\");\n      contentsVector = (data.Ok as number[]).flat(2 ** 16);\n    }\n\n    return {\n      ...state,\n      operandStates: [\n        ...state.operandStates.slice(0, index),\n        {\n          ...oldOperand,\n          shapeStr,\n          contentsVector,\n          contentsStr: contents\n        },\n        ...state.operandStates.slice(index + 1)\n      ]\n    };\n  } else {\n    throw new TypeError(JSON.stringify({ reducer: UPDATE_CONTENTS, action }));\n  }\n}\n\nexport default {\n  type: UPDATE_CONTENTS,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import range from \"../utils/range\";\nimport parseOutput from \"../utils/parseOutputString\";\nimport { operandState } from \"./appState\";\n\nexport default function makeOperand(\n  shape: number[],\n  start: number = 0,\n  step: number = 1\n): operandState {\n  if (shape.length === 0) {\n    return {\n      shapeStr: \"()\",\n      contentsStr: \"[]\",\n      contentsVector: []\n    };\n  }\n  const totalSize = shape.reduce((product, val) => val * product, 1);\n  const contents = range(start, start + step * totalSize, step);\n  const ndArray = parseOutput({ shape, contents });\n  return {\n    shapeStr: JSON.stringify(shape)\n      .replace(/\\[/g, \"(\")\n      .replace(/\\]/g, \")\"),\n    contentsStr: JSON.stringify(ndArray),\n    contentsVector: contents\n  };\n}\n","export default function range(start: number, stop?: number, step: number = 1) {\n  if (step === 0) {\n    throw new Error(\"range: step must not be zero\");\n  }\n  if (stop === undefined) {\n    stop = start;\n    start = 0;\n  }\n  const result: number[] = [];\n  let val = start;\n  while (val < stop) {\n    result.push(val);\n    val += step;\n  }\n  return result;\n}\n","import { AppState, operandState } from \"./appState\";\nimport makeOperand from \"./makeOperand\";\n\ntype PartialAppState = {\n  equation: string;\n  operandStates: operandState[];\n};\n\ntype Preset = {\n  description: string;\n  presetFn: () => PartialAppState;\n};\n\nconst presets: { [key: string]: Preset } = {\n  matrixMultiplication: {\n    description: \"Matrix Multiplication\",\n    presetFn: () => ({\n      equation: \"ij,jk->ik\",\n      operandStates: [makeOperand([2, 3], 0, 1), makeOperand([3, 5], 0, 10)]\n    })\n  },\n  matrixTransposition: {\n    description: \"Matrix Transposition (Implicit)\",\n    presetFn: () => ({\n      equation: \"ji\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  sum2D: {\n    description: \"Sum All Elements (2D)\",\n    presetFn: () => ({\n      equation: \"ij->\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  columnSum: {\n    description: \"Sum Each Column\",\n    presetFn: () => ({\n      equation: \"ij->j\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  rowSum: {\n    description: \"Sum Each Row\",\n    presetFn: () => ({\n      equation: \"ij->i\",\n      operandStates: [makeOperand([2, 3], 0, 1)]\n    })\n  },\n  getDiagonal: {\n    description: \"Take the Diagonal\",\n    presetFn: () => ({\n      equation: \"ii->i\",\n      operandStates: [makeOperand([3, 3], 0, 1)]\n    })\n  },\n  matrixVectorMultiplication: {\n    description: \"Matrix-Vector Multiplication\",\n    presetFn: () => ({\n      equation: \"ij,j->i\",\n      operandStates: [makeOperand([2, 3], 0, 1), makeOperand([3], 0, 10)]\n    })\n  },\n  outerProduct: {\n    description: \"Outer Product\",\n    presetFn: () => ({\n      equation: \"i,j->ij\",\n      operandStates: [makeOperand([3], 0, 1), makeOperand([4], 10, 10)]\n    })\n  },\n  batchMM1: {\n    description: \"Batch Matrix Multiplication (single RHS)\",\n    presetFn: () => ({\n      equation: \"nij,jk->nik\",\n      operandStates: [makeOperand([4, 2, 5], 0, 1), makeOperand([5, 3], 0, 10)]\n    })\n  },\n  batchMM2: {\n    description: \"Batch Matrix Multiplication (multiple RHS)\",\n    presetFn: () => ({\n      equation: \"nij,njk->nik\",\n      operandStates: [makeOperand([4, 2, 5], 0, 1), makeOperand([4, 5, 3], 0, 10)]\n    })\n  },\n  tensorContraction: {\n    description: \"Tensor Contraction\",\n    presetFn: () => ({\n      equation: \"pqrs,tuqvr->pstuv\",\n      operandStates: [makeOperand([2, 3, 5, 7], 0, 1), makeOperand([11, 13, 3, 17, 5], 0, 10)]\n    })\n  },\n  bilinearTransformation: {\n    description: \"Bilinear Transformation\",\n    presetFn: () => ({\n      equation: \"ik,jkl,il->ij\",\n      operandStates: [\n        makeOperand([2, 3], 0, 1),\n        makeOperand([5, 3, 7], 0, 10),\n        makeOperand([2, 7], 0, 100)\n      ]\n    })\n  }\n};\n\nexport function getState({ presetFn }: Preset): AppState {\n  const { equation, operandStates } = presetFn();\n  const visibleSizes = operandStates.length;\n  return {\n    equation,\n    visibleSizes,\n    operandStates: [...operandStates, ...Array(256 - visibleSizes).fill(makeOperand([]))]\n  };\n}\n\nexport default presets;\n","import { AppState, AppAction } from \"../appState\";\nimport { AnyAction } from \"../makeReducer\";\nimport presets, { getState } from \"../presets\";\n\nconst LOAD_PRESET = \"loadPreset\";\n\nexport interface LoadPresetAction extends AnyAction {\n  preset: string;\n}\n\nconst typeguard = (action: AppAction): action is LoadPresetAction =>\n  action.type === LOAD_PRESET &&\n  typeof (action as LoadPresetAction).preset === \"string\" &&\n  presets.hasOwnProperty((action as LoadPresetAction).preset);\n\nconst actionCreator = (preset: string): LoadPresetAction => ({\n  type: LOAD_PRESET,\n  preset\n});\n\nconst reducer = (state: AppState, action: AppAction): AppState => {\n  if (typeguard(action)) {\n    return getState(presets[action.preset]);\n  } else {\n    throw new TypeError(JSON.stringify({ action }));\n  }\n};\n\nexport default {\n  type: LOAD_PRESET,\n  typeguard,\n  actionCreator,\n  reducer\n};\n","import updateEquationDuck, { UpdateEquationAction } from \"./ducks/updateEquation\";\nimport updateShapeDuck, { UpdateShapeAction } from \"./ducks/updateShape\";\nimport updateContentsDuck, { UpdateContentsAction } from \"./ducks/updateContents\";\nimport makeReducer from \"./makeReducer\";\nimport presets, { getState } from \"./presets\";\nimport loadPresetDuck, { LoadPresetAction } from \"./ducks/loadPreset\";\n\n// What is the state of the app?\n// (1) The string the user entered\n// (2) How many arrays are visible that can have a size entered\n// (3) The shapes that have been entered (as strings)\n// (4) The contents that have been entered (as strings)\n//\n// Note: (1) and (2) can conflict\n// This is OK!\n// However, when the string changes, update (2) automatically if the new string is valid\n\n// To make a new action:\n// (1) Make a duck (type, typeguard, actionCreator, reducer)\n// (2) Export the duck and an interface extending AnyAction from the duck file\n// (3) Import the duck and the action in this file\n// (4) Add the action to \"type AppAction\"\n// (5) Add the action to \"const appActions\"\n// (6) Add the duck to the call to makeReducer()\n\nexport type operandState = {\n  shapeStr: string;\n  contentsStr: string;\n  contentsVector: number[];\n};\n\nexport type AppState = {\n  equation: string;\n  visibleSizes: number;\n  operandStates: operandState[];\n};\n\nconst initialState: AppState = getState(presets.matrixMultiplication);\n\nexport type AppAction =\n  | UpdateEquationAction\n  | UpdateShapeAction\n  | UpdateContentsAction\n  | LoadPresetAction;\n\nconst appActions = {\n  updateEquation: updateEquationDuck.actionCreator,\n  updateShape: updateShapeDuck.actionCreator,\n  updateContents: updateContentsDuck.actionCreator,\n  loadPreset: loadPresetDuck.actionCreator\n};\nconst reducer = makeReducer([\n  loadPresetDuck,\n  updateEquationDuck,\n  updateShapeDuck,\n  updateContentsDuck\n]);\n\nexport { initialState, reducer, appActions };\n","import { AppState, AppAction } from \"./appState\";\n\nexport interface AnyAction {\n  type: string;\n}\n\nexport type Reducer = (state: AppState, action: AppAction) => AppState;\nexport type ActionCreator = (...args: any[]) => AppAction;\nexport type ActionTypeGuard = (action: AppAction) => boolean;\nexport type Duck = {\n  type: string;\n  typeguard: ActionTypeGuard;\n  actionCreator: ActionCreator;\n  reducer: Reducer;\n};\n\nexport default function makeReducer(ducks: Duck[]): Reducer {\n  const appReducers: { [key: string]: Reducer } = {};\n\n  ducks.forEach(duck => {\n    if (appReducers[duck.type]) {\n      throw new Error(`Multiple declarations for ${duck.type}`);\n    } else {\n      appReducers[duck.type] = duck.reducer;\n    }\n  });\n\n  return (state: AppState, action: AppAction): AppState =>\n    appReducers[action.type](state, action);\n}\n","import React from \"react\";\n\ntype InputColumnProps = {\n  prompt: string;\n  control: JSX.Element;\n};\n\nexport default function InputColumn({ prompt, control }: InputColumnProps) {\n  return (\n    <div className=\"row\">\n      <div className=\"col-xs-4 col-lg-3\">{prompt}</div>\n      <div className=\"col-xs-7 col-lg-9\">{control}</div>\n    </div>\n  );\n}\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype ExplainerInputProps = {\n  equation: string;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst EquationInput = ({ equation, dispatch }: ExplainerInputProps) => {\n  const onEquationChange = (e: ChangeEvent<HTMLInputElement>) => {\n    dispatch(appActions.updateEquation(e.target.value));\n  };\n\n  return (\n    <InputColumn\n      prompt=\"Equation:\"\n      control={<input type=\"text\" onChange={onEquationChange} value={equation} />}\n    />\n  );\n};\n\nexport default React.memo(EquationInput);\n","import { Contraction } from \"../types/einsum_typeguards\";\n\nfunction makeLatexString(contraction: Contraction): string {\n  // Out_{i,k}=\\sum_j A_{i,j} B_{j,k}\n  const outputMatrix = `Out_{${contraction.output_indices.join(\",\")}}`;\n  const summationSymbols = contraction.summation_indices.map(idx => `\\\\sum_${idx}`).join(\" \");\n  function makeInputMatrix(indices: string, n: number) {\n    const asciiA: number = \"A\".charCodeAt(0);\n    const matrixName = String.fromCharCode(asciiA + n);\n    const subscripts = indices.split(\"\").join(\",\");\n\n    return `${matrixName}_{${subscripts}}`;\n  }\n  const inputMatrices = contraction.operand_indices.map(makeInputMatrix).join(\" \");\n\n  return `${outputMatrix} = ${summationSymbols} ${inputMatrices}`;\n}\n\nexport default makeLatexString;\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCheckCircle, faTimesCircle } from \"@fortawesome/free-solid-svg-icons\";\nimport { Result, isErrorMessage } from \"../../types/einsum_typeguards\";\n\ntype OutputColumnProps = {\n  output: Result<JSX.Element>;\n};\n\nexport default function OutputColumn({ output }: OutputColumnProps) {\n  return (\n    <div className=\"row\">\n      <div className=\"col-xs-2 col-xs-offset-2 col-md-offset-0 col-md-1\">\n        {isErrorMessage(output) ? (\n          <FontAwesomeIcon\n            title=\"Something went wrong!\"\n            icon={faTimesCircle}\n            size=\"2x\"\n            color=\"orangered\"\n          />\n        ) : (\n          <FontAwesomeIcon\n            title=\"Everything is cool!\"\n            icon={faCheckCircle}\n            size=\"2x\"\n            color=\"darkgreen\"\n          />\n        )}\n      </div>\n      <div className=\"col-xs-8 col-md-11\">\n        {isErrorMessage(output) ? output.Err : output.Ok}\n      </div>\n    </div>\n  );\n}\n","import { renderToString } from \"katex\";\nimport \"katex/dist/katex.min.css\";\nimport React from \"react\";\nimport { isErrorMessage, isContraction } from \"../types/einsum_typeguards\";\nimport makeLatexString from \"../utils/makeLatexString\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\n\ntype EquationOutputProps = {\n  explanationJSON: string;\n};\n\nconst EquationOutput = (props: EquationOutputProps) => {\n  const { explanationJSON } = props;\n  const explanation = parseAndTypecheckJSON(explanationJSON, isContraction, \"validateAsJson\");\n  const output = isErrorMessage(explanation)\n    ? explanation\n    : {\n        Ok: (\n          <div\n            dangerouslySetInnerHTML={{\n              __html: renderToString(makeLatexString(explanation.Ok))\n            }}\n          />\n        )\n      };\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(EquationOutput);\n","import React from \"react\";\n\ntype InputOutputProps = {\n  input: JSX.Element;\n  output: JSX.Element;\n};\n\nexport default function InputOutputRow({ input, output }: InputOutputProps) {\n  return (\n    <div className=\"row\" style={{ paddingTop: \"1em\", paddingBottom: \"1em\" }}>\n      <div className=\"col-xs-12 col-md-6\">{input}</div>\n      <div className=\"col-xs-12 col-md-6\">{output}</div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport EquationInput from \"./EquationInput\";\nimport { validateAsJson } from \"../pkg/einsum\";\nimport EquationOutput from \"./EquationOutput\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\n\ntype EquationProps = {\n  equation: string;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Equation = ({ equation, dispatch }: EquationProps) => {\n  const equationJSON = validateAsJson(equation);\n  return (\n    <InputOutputRow\n      input={<EquationInput equation={equation} dispatch={dispatch} />}\n      output={<EquationOutput explanationJSON={equationJSON} />}\n    />\n  );\n};\n\nexport default React.memo(Equation);\n","import React from \"react\";\nimport {\n  isErrorMessage,\n  isSizedContraction,\n  isContraction,\n  Result\n} from \"../types/einsum_typeguards\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\n\ntype AxisLengthOutputProps = {\n  equationJSON: string;\n  sizedExplanationJSON: string;\n};\n\nconst AxisLengthsOutput = ({ equationJSON, sizedExplanationJSON }: AxisLengthOutputProps) => {\n  let output: Result<JSX.Element>;\n\n  const explanation = parseAndTypecheckJSON(equationJSON, isContraction, \"validateAsJson\");\n\n  const sizedExplanation = parseAndTypecheckJSON(\n    sizedExplanationJSON,\n    isSizedContraction,\n    \"validateAndSizeFromShapesAsStringAsJson\"\n  );\n\n  if (isErrorMessage(sizedExplanation)) {\n    output = sizedExplanation;\n  } else if (isErrorMessage(explanation)) {\n    output = explanation;\n  } else {\n    // export type Contraction = {\n    //   operand_indices: string[];\n    //   output_indices: string[];\n    //   summation_indices: string[];\n    // };\n    const contraction = explanation.Ok;\n\n    // export type SizedContraction = {\n    //   contraction: Contraction;\n    //   output_size: OutputSize;\n    // };\n    // export type OutputSize = { [key: string]: number };\n    const outputMap = sizedExplanation.Ok.output_size;\n\n    output = {\n      Ok: (\n        <div>\n          <div>\n            Output size: [{contraction.output_indices.join(\", \")}] ={\" \"}\n            {JSON.stringify(contraction.output_indices.map(x => outputMap[x]))}\n          </div>\n          <div>\n            Summation index lengths:{\" \"}\n            {contraction.summation_indices.map(x => `${x}: ${outputMap[x]}`).join(\"; \")}\n          </div>\n        </div>\n      )\n    };\n  }\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(AxisLengthsOutput);\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype ShapesInputProps = {\n  visibleSizes: number;\n  operandShapes: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst ShapesInput = ({ operandShapes, visibleSizes, dispatch }: ShapesInputProps) => {\n  const shapes: string[] = [];\n  for (let i = 0; i < visibleSizes; i++) {\n    shapes.push(i < operandShapes.length ? operandShapes[i] : \"[]\");\n  }\n\n  const makeOnShapeChange = (index: number) => (e: ChangeEvent<HTMLInputElement>) => {\n    dispatch(appActions.updateShape(index, e.target.value));\n  };\n\n  return (\n    <>\n      {shapes.map((data, index) => (\n        <InputColumn\n          key={index}\n          prompt={`Shape of ${String.fromCharCode(index + \"A\".charCodeAt(0))}:`}\n          control={<input type=\"text\" onChange={makeOnShapeChange(index)} value={data} />}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default React.memo(ShapesInput);\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport { validateAndSizeFromShapesAsStringAsJson, validateAsJson } from \"../pkg/einsum\";\nimport AxisLengthsOutput from \"./AxisLengthsOutput\";\nimport { parseShapeString } from \"../utils/parseShapeStrings\";\nimport ShapesInput from \"./ShapesInput\";\nimport { isErrorMessage, ErrorMessage } from \"../types/einsum_typeguards\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\n\ntype ShapesProps = {\n  equation: string;\n  visibleSizes: number;\n  operandShapes: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Shapes = ({ equation, visibleSizes, operandShapes, dispatch }: ShapesProps) => {\n  const equationJSON = validateAsJson(equation);\n  const shapes = operandShapes.slice(0, visibleSizes);\n  const shapeArrays = shapes.map(parseShapeString);\n  let sizedExplanationJSON;\n  if (shapeArrays.some(isErrorMessage)) {\n    sizedExplanationJSON = JSON.stringify({\n      Err: JSON.stringify(\n        shapeArrays\n          .map((val, idx) => ({ val, idx }))\n          .filter(({ val }) => isErrorMessage(val))\n          .map(({ val, idx }) => ({ Tensor: idx, Error: (val as ErrorMessage).Err }))\n      )\n    });\n  } else {\n    sizedExplanationJSON = validateAndSizeFromShapesAsStringAsJson(\n      equation,\n      JSON.stringify(shapeArrays.map(x => (x as { Ok: number[] }).Ok))\n    );\n  }\n\n  return (\n    <InputOutputRow\n      input={\n        <ShapesInput\n          dispatch={dispatch}\n          visibleSizes={visibleSizes}\n          operandShapes={operandShapes}\n        />\n      }\n      output={\n        <AxisLengthsOutput\n          sizedExplanationJSON={sizedExplanationJSON}\n          equationJSON={equationJSON}\n        />\n      }\n    />\n  );\n};\n\nexport default React.memo(Shapes);\n","import React from \"react\";\nimport { isErrorMessage, isFlattenedOperand } from \"../types/einsum_typeguards\";\nimport parseOutput from \"../utils/parseOutputString\";\nimport parseAndTypecheckJSON from \"../utils/parseAndTypecheckJSON\";\nimport OutputColumn from \"./layout/OutputColumn\";\n\ntype ComputationOutputProps = {\n  computationOutputJSON: string;\n};\n\nconst ComputationOutput = (props: ComputationOutputProps) => {\n  const { computationOutputJSON } = props;\n  const computationOutput = parseAndTypecheckJSON(\n    computationOutputJSON,\n    isFlattenedOperand,\n    \"slowEinsumAsJson\"\n  );\n  const output = isErrorMessage(computationOutput)\n    ? computationOutput\n    : {\n        Ok: (\n          <>\n            Einsum Result:{\" \"}\n            <div>{JSON.stringify(parseOutput(computationOutput.Ok), null, 2)}</div>\n          </>\n        )\n      };\n\n  return <OutputColumn output={output} />;\n};\n\nexport default React.memo(ComputationOutput);\n","import React, { ChangeEvent } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\n\ntype ContentsInputProps = {\n  visibleSizes: number;\n  operandContents: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst ContentsInput = ({ operandContents, visibleSizes, dispatch }: ContentsInputProps) => {\n  const contents: string[] = [];\n  for (let i = 0; i < visibleSizes; i++) {\n    contents.push(i < operandContents.length ? operandContents[i] : \"[]\");\n  }\n\n  const makeOnContentsChange = (index: number) => (e: ChangeEvent<HTMLInputElement>) => {\n    dispatch(appActions.updateContents(index, e.target.value));\n  };\n\n  return (\n    <>\n      {contents.map((data, index) => (\n        <InputColumn\n          prompt={`Contents of ${String.fromCharCode(index + \"A\".charCodeAt(0))}:`}\n          control={<input type=\"text\" onChange={makeOnContentsChange(index)} value={data} />}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default React.memo(ContentsInput);\n","import React from \"react\";\nimport { AppAction } from \"../appstate/appState\";\nimport { slowEinsumAsJson } from \"../pkg/einsum\";\nimport ComputationOutput from \"./ComputationOutput\";\nimport { parseShapeString } from \"../utils/parseShapeStrings\";\nimport ContentsInput from \"./ContentsInput\";\nimport { isErrorMessage } from \"../types/einsum_typeguards\";\nimport { parseDataString } from \"../utils/parseDataString\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\n\ntype ComputationProps = {\n  equation: string;\n  visibleSizes: number;\n  operandShapes: string[];\n  operandContents: string[];\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Computation = ({\n  equation,\n  visibleSizes,\n  operandShapes,\n  operandContents,\n  dispatch\n}: ComputationProps) => {\n  const shapes = operandShapes.slice(0, visibleSizes);\n  const contents = operandContents.slice(0, visibleSizes);\n  const operands = [];\n  for (let i = 0; i < Math.min(shapes.length, contents.length); i++) {\n    const shape = parseShapeString(shapes[i]);\n    const data = parseDataString(contents[i]);\n\n    if (!isErrorMessage(shape) && !isErrorMessage(data) && typeof data.Ok !== \"number\") {\n      operands.push({\n        shape: shape.Ok,\n        contents: data.Ok.flat(2 ** 16)\n      });\n    } else {\n      operands.push({\n        Err: `Array ${i} doesn't work`\n      });\n    }\n  }\n\n  const operandsJSON = JSON.stringify(operands);\n  const computationOutputJSON = slowEinsumAsJson(equation, operandsJSON);\n\n  return (\n    <InputOutputRow\n      input={\n        <ContentsInput\n          dispatch={dispatch}\n          visibleSizes={visibleSizes}\n          operandContents={operandContents}\n        />\n      }\n      output={<ComputationOutput computationOutputJSON={computationOutputJSON} />}\n    />\n  );\n};\n\nexport default React.memo(Computation);\n","import React, { ChangeEvent, useState } from \"react\";\nimport { appActions, AppAction } from \"../appstate/appState\";\nimport InputColumn from \"./layout/InputColumn\";\nimport InputOutputRow from \"./layout/InputOutputRow\";\nimport presets from \"../appstate/presets\";\n\ntype PresetsProps = {\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst Presets = ({ dispatch }: PresetsProps) => {\n  const presetChoices = Object.entries(presets);\n  const [selectedPreset, setSelectedPreset] = useState(presetChoices[0][0]);\n  const onPresetSelect = (e: ChangeEvent<HTMLSelectElement>) => {\n    setSelectedPreset(e.target.value);\n    dispatch(appActions.loadPreset(e.target.value));\n  };\n\n  return (\n    <InputOutputRow\n      input={\n        <InputColumn\n          prompt=\"Try one:\"\n          control={\n            <select value={selectedPreset} onChange={onPresetSelect}>\n              {presetChoices.map(([name, preset]) => (\n                <option key={name} value={name}>\n                  {preset.description}\n                </option>\n              ))}\n            </select>\n          }\n        />\n      }\n      output={<></>}\n    />\n  );\n};\n\nexport default React.memo(Presets);\n","import React from \"react\";\nimport { AppState, AppAction } from \"../appstate/appState\";\nimport Equation from \"./Equation\";\nimport Shapes from \"./Shapes\";\nimport Computation from \"./Computation\";\nimport Presets from \"./Presets\";\n\ntype EinsumExplainerProps = {\n  appState: AppState;\n  dispatch: React.Dispatch<AppAction>;\n};\n\nconst EinsumExplainer = ({ appState, dispatch }: EinsumExplainerProps) => {\n  const { equation, visibleSizes, operandStates } = appState;\n\n  return (\n    <div className=\"wrap container-fluid\">\n      <Presets dispatch={dispatch} />\n      <Equation equation={equation} dispatch={dispatch} />\n      <Shapes\n        equation={equation}\n        dispatch={dispatch}\n        visibleSizes={visibleSizes}\n        operandShapes={operandStates.map(x => x.shapeStr)}\n      />\n      <Computation\n        equation={equation}\n        dispatch={dispatch}\n        visibleSizes={visibleSizes}\n        operandContents={operandStates.map(x => x.contentsStr)}\n        operandShapes={operandStates.map(x => x.shapeStr)}\n      />\n    </div>\n  );\n};\n\nexport default EinsumExplainer;\n","import React, { useReducer, useState } from \"react\";\nimport { reducer, initialState } from \"../appstate/appState\";\nimport EinsumExplainer from \"./EinsumExplainer\";\n\nimport \"./App.css\";\nimport \"flexboxgrid\";\n\nconst App = () => {\n  const [appState, dispatch] = useReducer(reducer, initialState);\n  const [, setReloadTime] = useState(Date.now());\n\n  if (module.hot) {\n    module.hot.accept(\"./EinsumExplainer\", () => {\n      setReloadTime(Date.now());\n    });\n  }\n\n  return <EinsumExplainer appState={appState} dispatch={dispatch} />;\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./components/App\";\nimport * as serviceWorker from \"./utils/serviceWorker\";\nimport init from \"./pkg/einsum.js\";\n\n(async function run() {\n  await init(\"./pkg/einsum_bg.wasm\");\n  ReactDOM.render(<App />, document.getElementById(\"root\"));\n})();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}