(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){e.exports=n(29)},20:function(e,t,n){},27:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var r,a,i=n(6),o=n.n(i),u=n(11),c=n(0),s=n.n(c),l=n(12),p=n.n(l),f=(n(20),n(3)),d=n(4),m={},v=0,h=new TextEncoder("utf-8"),y=null;function g(){return null!==y&&y.buffer===r.memory.buffer||(y=new Uint8Array(r.memory.buffer)),y}a="function"===typeof h.encodeInto?function(e){for(var t=e.length,n=r.__wbindgen_malloc(t),a=0;;){var i=g().subarray(n+a,n+t),o=h.encodeInto(e,i),u=o.read;if(a+=o.written,u===e.length)break;e=e.substring(u),n=r.__wbindgen_realloc(n,t,t+=3*e.length)}return v=a,n}:function(e){var t=h.encode(e),n=r.__wbindgen_malloc(t.length);return g().set(t,n),v=t.length,n};var S=new TextDecoder("utf-8");function b(e,t){return S.decode(g().subarray(e,e+t))}var O=null;function w(){return null===O&&(O=r.__wbindgen_global_argument_ptr()),O}var E=null;function _(){return null!==E&&E.buffer===r.memory.buffer||(E=new Uint32Array(r.memory.buffer)),E}function j(e){var t=a(e),n=v,i=w();try{r.validateAsJson(i,t,n);var o=_(),u=o[i/4],c=o[i/4+1],s=b(u,c).slice();return r.__wbindgen_free(u,1*c),s}finally{r.__wbindgen_free(t,1*n)}}function k(e,t){var n=a(e),i=v,o=a(t),u=v,c=w();try{r.validateAndSizeFromShapesAsStringAsJson(c,n,i,o,u);var s=_(),l=s[c/4],p=s[c/4+1],f=b(l,p).slice();return r.__wbindgen_free(l,1*p),f}finally{r.__wbindgen_free(n,1*i),r.__wbindgen_free(o,1*u)}}function A(e,t){var n=a(e),i=v,o=a(t),u=v,c=w();try{r.slowEinsumAsJson(c,n,i,o,u);var s=_(),l=s[c/4],p=s[c/4+1],f=b(l,p).slice();return r.__wbindgen_free(l,1*p),f}finally{r.__wbindgen_free(n,1*i),r.__wbindgen_free(o,1*u)}}m.validateAsJson=j,m.validateAndSizeFromShapesAsStringAsJson=k,m.slowEinsumAsJson=A;var x=new Array(32);x.fill(void 0),x.push(void 0,null,!0,!1);var N=x.length;m.__wbindgen_object_drop_ref=function(e){var t;(t=e)<36||(x[t]=N,N=t)};var q=function e(t){var n,a={"./einsum":m};if(t instanceof URL||"string"===typeof t||t instanceof Request){var i=fetch(t);n="function"===typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(i,a).catch(function(e){return console.warn("`WebAssembly.instantiateStreaming` failed. Assuming this is because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e),i.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,a)})}):i.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.instantiate(e,a)})}else n=WebAssembly.instantiate(t,a).then(function(e){return e instanceof WebAssembly.Instance?{instance:e,module:t}:e});return n.then(function(t){var n=t.instance,a=t.module;return r=n.exports,e.__wbindgen_wasm_module=a,r})},J=n(2);function C(e){return e.hasOwnProperty("Err")}function z(e){return e instanceof Array&&e.every(function(e){return"number"===typeof e})}function M(e){if("number"===typeof e)return{Ok:[]};var t=M(e[0]);if(C(t))return t;for(var n=function(n){var r=M(e[n]);return C(r)?{v:r}:t.Ok.every(function(e,t){return r.Ok[t]===e})?void 0:{v:{Err:"Array contains elements with different shapes"}}},r=1;r<e.length;r++){var a=n(r);if("object"===typeof a)return a.v}return{Ok:[e.length].concat(Object(J.a)(t.Ok))}}function P(e){return!!function e(t){if("number"===typeof t)return!0;if(!(t instanceof Array))return!1;if(z(t)&&0!==t.length)return!0;var n=t[0];if(!(n instanceof Array)||0===n.length)return!1;var r=n.length;return 0!==r&&t.every(function(t){return t instanceof Array&&t.length===r&&e(t)})}(e)&&!C(M(e))}function F(e){return e.hasOwnProperty("operand_indices")&&e.operand_indices instanceof Array&&e.hasOwnProperty("output_indices")&&e.hasOwnProperty("summation_indices")}function T(e){return e.hasOwnProperty("contraction")&&F(e.contraction)&&e.hasOwnProperty("output_size")&&function(e){return Object.entries(e).every(function(e){var t=Object(f.a)(e,2);return t[0],"number"===typeof t[1]})}(e.output_size)}function W(e){return e.hasOwnProperty("shape")&&z(e.shape)&&e.hasOwnProperty("contents")&&z(e.contents)}function B(e,t,n){var r;try{r=JSON.parse(e)}catch(a){return{Err:"".concat(n," returned invalid JSON")}}return function(e,t,n){return function(e,t){return e.hasOwnProperty("Ok")&&t(e.Ok)}(e,t)?e:C(e)?e:n}(r,t,{Err:"".concat(n," returned valid JSON but of the wrong type")})}var V=function(e){return"updateEquation"===e.type&&e.hasOwnProperty("equation")&&"string"===typeof e.equation},I={type:"updateEquation",typeguard:V,actionCreator:function(e){return{type:"updateEquation",equation:e}},reducer:function(e,t){if(V(t)){var n=t.equation,r=e.visibleSizes,a=B(j(n),F,"validateAsJson");return C(a)||(r=a.Ok.operand_indices.length),Object(d.a)({},e,{visibleSizes:r,equation:t.equation})}throw new TypeError(JSON.stringify({action:t}))}};function R(e){var t,n=e.replace(/\(/g,"[").replace(/\)/g,"]");try{t=JSON.parse(n)}catch(r){return{Err:"Not a valid shape"}}return z(t)?{Ok:t}:{Err:"Not a valid shape"}}function D(e){return function e(t,n){switch(t.length){case 0:return n[0];case 1:return n.slice();default:for(var r=[],a=1,i=1;i<t.length;i++)a*=t[i];for(var o=0;o<t[0];o++)r.push(e(t.slice(1),n.slice(o*a,(o+1)*a)));return r}}(e.shape,e.contents)}var H="updateShape";function U(e){return e.type===H&&e.hasOwnProperty("index")&&"number"===typeof e.index&&e.hasOwnProperty("shape")&&"string"===typeof e.shape}function L(e,t){var n=1,r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){n*=o.value}}catch(l){a=!0,i=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}if(!(e instanceof Array))return Array(n).fill(0);for(var c=[],s=0;s<n;s++)"number"!==typeof e[s]?c.push(0):c.push(e[s]);return c}var $={type:H,typeguard:U,actionCreator:function(e,t){return{type:H,index:e,shape:t}},reducer:function(e,t){if(U(t)){var n=t.index,r=t.shape,a=R(r),i=e.operandStates[n],o=i.contentsVector,u=i.contentsStr;if(!C(a)){var c=D({shape:a.Ok,contents:L(o,a.Ok)});u=JSON.stringify(c)}return Object(d.a)({},e,{operandStates:[].concat(Object(J.a)(e.operandStates.slice(0,n)),[Object(d.a)({},i,{shapeStr:r,contentsStr:u,contentsVector:o})],Object(J.a)(e.operandStates.slice(n+1)))})}throw new TypeError(JSON.stringify({reducer:H,action:t}))}};function G(e){var t,n=e.replace(/\(/g,"[").replace(/\)/g,"]");try{t=JSON.parse(n)}catch(r){return{Err:"Not a valid ndArray"}}return P(t)?{Ok:t}:{Err:"Not a valid ndArray"}}var K="updateContents";function Q(e){return e.type===K&&e.hasOwnProperty("index")&&"number"===typeof e.index&&e.hasOwnProperty("contents")&&"string"===typeof e.contents}var X={type:K,typeguard:Q,actionCreator:function(e,t){return{type:K,index:e,contents:t}},reducer:function(e,t){if(Q(t)){var n=t.index,r=t.contents,a=G(r),i=e.operandStates[n],o=i.shapeStr,u=i.contentsVector;if(!C(a)){var c=M(a.Ok);if(C(c))throw new Error("This shouldn't be possible");o=JSON.stringify(c.Ok).replace(/\[/g,"(").replace(/\]/g,")"),u=a.Ok.flat(Math.pow(2,16))}return Object(d.a)({},e,{operandStates:[].concat(Object(J.a)(e.operandStates.slice(0,n)),[Object(d.a)({},i,{shapeStr:o,contentsVector:u,contentsStr:r})],Object(J.a)(e.operandStates.slice(n+1)))})}throw new TypeError(JSON.stringify({reducer:K,action:t}))}};function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===e.length)return{shapeStr:"()",contentsStr:"[]",contentsVector:[]};var r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===n)throw new Error("range: step must not be zero");void 0===t&&(t=e,e=0);for(var r=[],a=e;a<t;)r.push(a),a+=n;return r}(t,t+n*e.reduce(function(e,t){return t*e},1),n),a=D({shape:e,contents:r});return{shapeStr:JSON.stringify(e).replace(/\[/g,"(").replace(/\]/g,")"),contentsStr:JSON.stringify(a),contentsVector:r}}function Z(e){var t=(0,e.presetFn)(),n=t.equation,r=t.operandStates,a=r.length;return{equation:n,visibleSizes:a,operandStates:[].concat(Object(J.a)(r),Object(J.a)(Array(256-a).fill(Y([]))))}}var ee={matrixMultiplication:{description:"Matrix Multiplication",presetFn:function(){return{equation:"ij,jk->ik",operandStates:[Y([2,3],0,1),Y([3,5],0,10)]}}},matrixTransposition:{description:"Matrix Transposition (Implicit)",presetFn:function(){return{equation:"ji",operandStates:[Y([2,3],0,1)]}}},sum2D:{description:"Sum All Elements (2D)",presetFn:function(){return{equation:"ij->",operandStates:[Y([2,3],0,1)]}}},columnSum:{description:"Sum Each Column",presetFn:function(){return{equation:"ij->j",operandStates:[Y([2,3],0,1)]}}},rowSum:{description:"Sum Each Row",presetFn:function(){return{equation:"ij->i",operandStates:[Y([2,3],0,1)]}}},getDiagonal:{description:"Take the Diagonal",presetFn:function(){return{equation:"ii->i",operandStates:[Y([3,3],0,1)]}}},matrixVectorMultiplication:{description:"Matrix-Vector Multiplication",presetFn:function(){return{equation:"ij,j->i",operandStates:[Y([2,3],0,1),Y([3],0,10)]}}},outerProduct:{description:"Outer Product",presetFn:function(){return{equation:"i,j->ij",operandStates:[Y([3],0,1),Y([4],10,10)]}}},batchMM1:{description:"Batch Matrix Multiplication (single RHS)",presetFn:function(){return{equation:"nij,jk->nik",operandStates:[Y([4,2,5],0,1),Y([5,3],0,10)]}}},batchMM2:{description:"Batch Matrix Multiplication (multiple RHS)",presetFn:function(){return{equation:"nij,njk->nik",operandStates:[Y([4,2,5],0,1),Y([4,5,3],0,10)]}}},tensorContraction:{description:"Tensor Contraction",presetFn:function(){return{equation:"pqrs,tuqvr->pstuv",operandStates:[Y([2,3,5,7],0,1),Y([11,13,3,17,5],0,10)]}}},bilinearTransformation:{description:"Bilinear Transformation",presetFn:function(){return{equation:"ik,jkl,il->ij",operandStates:[Y([2,3],0,1),Y([5,3,7],0,10),Y([2,7],0,100)]}}}},te=function(e){return"loadPreset"===e.type&&"string"===typeof e.preset&&ee.hasOwnProperty(e.preset)},ne={type:"loadPreset",typeguard:te,actionCreator:function(e){return{type:"loadPreset",preset:e}},reducer:function(e,t){if(te(t))return Z(ee[t.preset]);throw new TypeError(JSON.stringify({action:t}))}},re=Z(ee.matrixMultiplication),ae={updateEquation:I.actionCreator,updateShape:$.actionCreator,updateContents:X.actionCreator,loadPreset:ne.actionCreator},ie=function(e){var t={};return e.forEach(function(e){if(t[e.type])throw new Error("Multiple declarations for ".concat(e.type));t[e.type]=e.reducer}),function(e,n){return t[n.type](e,n)}}([ne,I,$,X]);function oe(e){var t=e.prompt,n=e.control;return s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-4 col-lg-3"},t),s.a.createElement("div",{className:"col-xs-7 col-lg-9"},n))}var ue=s.a.memo(function(e){var t=e.equation,n=e.dispatch;return s.a.createElement(oe,{prompt:"Equation:",control:s.a.createElement("input",{type:"text",onChange:function(e){n(ae.updateEquation(e.target.value))},value:t})})}),ce=n(13);n(21);var se=function(e){var t="Out_{".concat(e.output_indices.join(","),"}"),n=e.summation_indices.map(function(e){return"\\sum_".concat(e)}).join(" "),r=e.operand_indices.map(function(e,t){var n="A".charCodeAt(0),r=String.fromCharCode(n+t),a=e.split("").join(",");return"".concat(r,"_{").concat(a,"}")}).join(" ");return"".concat(t," = ").concat(n," ").concat(r)},le=n(7),pe=n(9);function fe(e){var t=e.output;return s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xs-2 col-xs-offset-2 col-md-offset-0 col-md-1"},C(t)?s.a.createElement(le.a,{title:"Something went wrong!",icon:pe.b,size:"2x",color:"orangered"}):s.a.createElement(le.a,{title:"Everything is cool!",icon:pe.a,size:"2x",color:"darkgreen"})),s.a.createElement("div",{className:"col-xs-8 col-md-11"},C(t)?t.Err:t.Ok))}var de=s.a.memo(function(e){var t=B(e.explanationJSON,F,"validateAsJson"),n=C(t)?t:{Ok:s.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(ce.renderToString)(se(t.Ok))}})};return s.a.createElement(fe,{output:n})});function me(e){var t=e.input,n=e.output;return s.a.createElement("div",{className:"row",style:{paddingTop:"1em",paddingBottom:"1em"}},s.a.createElement("div",{className:"col-xs-12 col-md-6"},t),s.a.createElement("div",{className:"col-xs-12 col-md-6"},n))}var ve=s.a.memo(function(e){var t=e.equation,n=e.dispatch,r=j(t);return s.a.createElement(me,{input:s.a.createElement(ue,{equation:t,dispatch:n}),output:s.a.createElement(de,{explanationJSON:r})})}),he=s.a.memo(function(e){var t,n=e.equationJSON,r=e.sizedExplanationJSON,a=B(n,F,"validateAsJson"),i=B(r,T,"validateAndSizeFromShapesAsStringAsJson");if(C(i))t=i;else if(C(a))t=a;else{var o=a.Ok,u=i.Ok.output_size;t={Ok:s.a.createElement("div",null,s.a.createElement("div",null,"Output size: [",o.output_indices.join(", "),"] ="," ",JSON.stringify(o.output_indices.map(function(e){return u[e]}))),s.a.createElement("div",null,"Summation index lengths:"," ",o.summation_indices.map(function(e){return"".concat(e,": ").concat(u[e])}).join("; ")))}}return s.a.createElement(fe,{output:t})}),ye=s.a.memo(function(e){for(var t=e.operandShapes,n=e.visibleSizes,r=e.dispatch,a=[],i=0;i<n;i++)a.push(i<t.length?t[i]:"[]");var o=function(e){return function(t){r(ae.updateShape(e,t.target.value))}};return s.a.createElement(s.a.Fragment,null,a.map(function(e,t){return s.a.createElement(oe,{key:t,prompt:"Shape of ".concat(String.fromCharCode(t+"A".charCodeAt(0)),":"),control:s.a.createElement("input",{type:"text",onChange:o(t),value:e})})}))}),ge=s.a.memo(function(e){var t,n=e.equation,r=e.visibleSizes,a=e.operandShapes,i=e.dispatch,o=j(n),u=a.slice(0,r).map(R);return t=u.some(C)?JSON.stringify({Err:JSON.stringify(u.map(function(e,t){return{val:e,idx:t}}).filter(function(e){return C(e.val)}).map(function(e){var t=e.val;return{Tensor:e.idx,Error:t.Err}}))}):k(n,JSON.stringify(u.map(function(e){return e.Ok}))),s.a.createElement(me,{input:s.a.createElement(ye,{dispatch:i,visibleSizes:r,operandShapes:a}),output:s.a.createElement(he,{sizedExplanationJSON:t,equationJSON:o})})}),Se=s.a.memo(function(e){var t=B(e.computationOutputJSON,W,"slowEinsumAsJson"),n=C(t)?t:{Ok:s.a.createElement(s.a.Fragment,null,"Einsum Result:"," ",s.a.createElement("div",null,JSON.stringify(D(t.Ok),null,2)))};return s.a.createElement(fe,{output:n})}),be=s.a.memo(function(e){for(var t=e.operandContents,n=e.visibleSizes,r=e.dispatch,a=[],i=0;i<n;i++)a.push(i<t.length?t[i]:"[]");var o=function(e){return function(t){r(ae.updateContents(e,t.target.value))}};return s.a.createElement(s.a.Fragment,null,a.map(function(e,t){return s.a.createElement(oe,{prompt:"Contents of ".concat(String.fromCharCode(t+"A".charCodeAt(0)),":"),control:s.a.createElement("input",{type:"text",onChange:o(t),value:e})})}))}),Oe=s.a.memo(function(e){for(var t=e.equation,n=e.visibleSizes,r=e.operandShapes,a=e.operandContents,i=e.dispatch,o=r.slice(0,n),u=a.slice(0,n),c=[],l=0;l<Math.min(o.length,u.length);l++){var p=R(o[l]),f=G(u[l]);C(p)||C(f)||"number"===typeof f.Ok?c.push({Err:"Array ".concat(l," doesn't work")}):c.push({shape:p.Ok,contents:f.Ok.flat(Math.pow(2,16))})}var d=A(t,JSON.stringify(c));return s.a.createElement(me,{input:s.a.createElement(be,{dispatch:i,visibleSizes:n,operandContents:a}),output:s.a.createElement(Se,{computationOutputJSON:d})})}),we=s.a.memo(function(e){var t=e.dispatch,n=Object.entries(ee),r=Object(c.useState)(n[0][0]),a=Object(f.a)(r,2),i=a[0],o=a[1];return s.a.createElement(me,{input:s.a.createElement(oe,{prompt:"Try one:",control:s.a.createElement("select",{value:i,onChange:function(e){o(e.target.value),t(ae.loadPreset(e.target.value))}},n.map(function(e){var t=Object(f.a)(e,2),n=t[0],r=t[1];return s.a.createElement("option",{key:n,value:n},r.description)}))}),output:s.a.createElement(s.a.Fragment,null)})}),Ee=function(e){var t=e.appState,n=e.dispatch,r=t.equation,a=t.visibleSizes,i=t.operandStates;return s.a.createElement("div",{className:"wrap container-fluid"},s.a.createElement(we,{dispatch:n}),s.a.createElement(ve,{equation:r,dispatch:n}),s.a.createElement(ge,{equation:r,dispatch:n,visibleSizes:a,operandShapes:i.map(function(e){return e.shapeStr})}),s.a.createElement(Oe,{equation:r,dispatch:n,visibleSizes:a,operandContents:i.map(function(e){return e.contentsStr}),operandShapes:i.map(function(e){return e.shapeStr})}))},_e=(n(27),n(28),function(){var e=Object(c.useReducer)(ie,re),t=Object(f.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(Date.now());Object(f.a)(a,2)[1];return s.a.createElement(Ee,{appState:n,dispatch:r})});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=Object(u.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q("./pkg/einsum_bg.wasm");case 2:p.a.render(s.a.createElement(_e,null),document.getElementById("root"));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.3a61d15c.chunk.js.map